import"./vue-DSB24BnW.js";import{u as A,a as B}from"./vue-router-fyTrc5Va.js";import E from"./selectUser-DTjGt176.js";import{_ as O}from"./index-CR9DtD1f.js";import{f as j}from"./index-M3ohjitV.js";import{a as x,b as F,c as K}from"./role-a4XAtDMh.js";import{a as v,c as L}from"./element-plus-Cdmo8XhC.js";import{d as P,r as c,v as d,f as V,u as f,h as s,c as M,i as o,j as r,o as J,a as Q,ak as U,m as _}from"./@vue-CmN6Z9lx.js";import"./ace-builds-DiBK84cm.js";import"./vuex-CLkfaZ6_.js";import"./js-cookie-Cz0CWeBA.js";import"./path-browserify-Jw_v0k3c.js";import"./@vueuse-D81fD1wx.js";import"./nprogress-C9k5oxGd.js";import"./axios-BNZxzx77.js";import"./@element-plus-DGCe4rM-.js";/* empty css                    */import"./dayjs-BhI1duP8.js";import"./element-easy-form-Dkjp9jsl.js";import"./mockjs-72j0mDZC.js";import"./vuedraggable-C0hio2tq.js";import"./sortablejs-CUXm9Ppf.js";import"./vue3-ace-editor-YX3apWn1.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./uuid-CQkTLCs1.js";import"./vue-i18n-BPZ2p18e.js";import"./@intlify-fCQYzvHO.js";import"./element-easy-print-B_PXcQ-3.js";import"./vue3-draggable-resizable-yn-Cm3Ut1tY.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";const $={class:"commonBoxmp"},G={class:"jcb aic w100"},Ae=P({__name:"authUser",setup(H){A();const b=B(),{parseTime:W,addDateRange:X,getDict:k}=j();c(!0);const g=c(),m=d({openDataScope:!1,defaultProps:{children:"children",label:"label"},menuOptions:[],deptOptions:[],deptExpand:!1,deptNodeAll:!1,menuExpand:!1,menuNodeAll:!1,title:"",form:{},userVisible:!1,rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"用户名称",visible:!0,prop:"userName"},{label:"用户昵称",visible:!0,prop:"nickName"},{label:"邮箱",visible:!0,prop:"email"},{label:"手机",prop:"phonenumber",visible:!0},{label:"状态",visible:!0,prop:"status",render:({row:t})=>o(O,{values:t.status,dataType:"primary",options:N.sys_normal_disable},null)},{label:"创建时间",visible:!0,prop:"createTime"}],loading:!1}),h=d({currentPage:1,total:10,pageSize:10,pageSizes:[10,20,30,40],layout:"total, prev, pager, next,sizes"}),I={pageNum:1,pageSize:10,userName:"",phonenumber:""},e=d(JSON.parse(JSON.stringify(I))),p=()=>{e.pageNum=1;let t=f(e);g.value.getList(t)},S=()=>{Object.assign(e,I),p()},w=t=>{const a=e.roleId;L.confirm('确认要取消该用户"'+t.userName+'"角色吗？').then(function(){return K({userId:t.userId,roleId:a})}).then(()=>{v.success("取消授权成功")}).catch(function(){})};let y=c();const z=()=>{y.value.show()},C=()=>{m.loading=!0,e.pageNum=h.currentPage,e.pageSize=h.pageSize,x(e).then(t=>{m.tableData=t.rows,h.total=t.total,m.loading=!1})};c();const R=t=>{const a=e.roleId,n=t.ids.join(",");if(n==""){v.error("请选择要分配的用户");return}F({roleId:a,userIds:n}).then(l=>{v.success(l.msg),l.code===200&&y.value.hide()})};let N=d({sys_normal_disable:[]});return V(async()=>{N.sys_normal_disable=await k("sys_normal_disable"),C()}),V(()=>{const t=b.params&&b.params.roleId;if(t){e.roleId=t;let a=f(e);g.value.getList(a)}}),(t,a)=>{const n=s("el-input"),l=s("el-form-item"),u=s("el-button"),D=s("el-form"),T=s("el-table-column"),q=s("TableV2");return J(),M("div",$,[o(q,{class:"flex1",apiFunction:f(x),ref_key:"tableV2Ref",ref:g,columns:m.columnData},{tableHeader:r(()=>[Q("div",G,[o(D,{model:e,ref:"queryForm",size:"small",inline:!0},{default:r(()=>[o(l,{label:"用户名称",prop:"userName"},{default:r(()=>[o(n,{modelValue:e.userName,"onUpdate:modelValue":a[0]||(a[0]=i=>e.userName=i),placeholder:"请输入用户名称",clearable:"",style:{width:"240px"},onKeyup:U(p,["enter","native"])},null,8,["modelValue"])]),_:1}),o(l,{label:"手机号码",prop:"phonenumber"},{default:r(()=>[o(n,{modelValue:e.phonenumber,"onUpdate:modelValue":a[1]||(a[1]=i=>e.phonenumber=i),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:U(p,["enter","native"])},null,8,["modelValue"])]),_:1}),o(l,null,{default:r(()=>[o(u,{type:"primary",size:"mini",onClick:p},{default:r(()=>[_("搜索")]),_:1}),o(u,{size:"mini",onClick:S},{default:r(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"]),o(u,{type:"primary",onClick:z},{default:r(()=>[_("添加用户")]),_:1})])]),operation:r(()=>[o(T,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:r(i=>[o(u,{type:"text",onClick:Y=>w(i.row)},{default:r(()=>[_("取消授权")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),o(E,{ref_key:"selectUserRef",ref:y,onGetUsers:R,roleId:f(b).params.roleId},null,8,["roleId"])])}}});export{Ae as default};
