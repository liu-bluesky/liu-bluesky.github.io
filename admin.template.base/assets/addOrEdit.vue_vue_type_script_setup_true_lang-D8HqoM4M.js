import"./vue-BOAnm8BJ.js";import{b as T,c as B,d as J,a as S}from"./user-BQx4WHv-.js";import{e as R,q as j}from"./index-CxwxT6J_.js";import{b as z}from"./config-C-MPfl_P.js";import{u as L}from"./vue-i18n-CbYyLErm.js";import{a as w}from"./element-plus-DCyP7bP4.js";import{d as M,s as V,r as N,A as K,w as _,i as r,o as p,m as c,k as o,a as W,j as n,q as E,c as A,l as k,F as C,u as $}from"./@vue-C7kBaxf_.js";const te=M({__name:"addOrEdit",props:{modelValue:{type:Boolean,defalut:!1},id:{type:String,defalut:""}},emits:["update:modelValue","update"],setup(f,{emit:O}){const{t:g}=L(),i=O,u=V(!1),P=V(!1),b=N(),x=async()=>{try{const e=await b.value.validate();d.id?T(e).then(t=>{w.success(g("操作成功")),m(),i("update")}):B(e).then(t=>{w.success(g("操作成功")),m(),i("update")})}catch(e){console.log("error :>> ",e)}},s=K({deptOptions:[],postOptions:[],roleOptions:[],initPassword:""}),l=N({schema:[{label:"用户昵称",prop:"nickName",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请输入名字"},rules:[{required:!0,message:"不能为空",trigger:"change"}]},{label:"归属部门",prop:"deptId",colAttrs:{span:12},componentName:"ElDatePicker",attrs:{placeholder:"请选择"},rules:[{required:!1,message:"不能为空",trigger:"change"}]},{label:"手机号码",prop:"phonenumber",colAttrs:{span:12},componentName:"ElInput",rules:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],attrs:{type:"number",placeholder:"请选择"}},{label:"邮箱",prop:"email",colAttrs:{span:12},componentName:"ElInput",rules:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],attrs:{type:"number",placeholder:"请选择"}},{label:"用户名称",prop:"userName",colAttrs:{span:12},rules:[{required:!0,message:"不能为空",trigger:"change"}],componentName:"ElInput",hidden:{matchPattern:"&&",dataSelect:[],type:"function",value:!1,dataJs:(e,t)=>t.userId!=null},attrs:{placeholder:"请输入"}},{label:"用户密码",prop:"password",colAttrs:{span:12},rules:[{required:!0,message:"用户密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}],componentName:"ElInput",hidden:{matchPattern:"&&",dataSelect:[],type:"function",value:!1,dataJs:(e,t)=>t.userId!=null},attrs:{maxlength:"20",placeholder:"请输入",showPassword:!0}},{label:"性别",prop:"sex",colAttrs:{span:12},componentName:"selectDict",attrs:{dictCode:"sys_user_sex",placeholder:"请选择",showPassword:!0}},{label:"状态",prop:"status",colAttrs:{span:12},componentName:"selectDict",attrs:{dictCode:"sys_normal_disable",placeholder:"请选择",showPassword:!0}},{label:"岗位",prop:"postIds",colAttrs:{span:12},componentName:"ElInput",attrs:{}},{label:"角色",prop:"roleIds",colAttrs:{span:12},componentName:"ElInput",attrs:{}},{label:"备注",type:"COMPONENT",formItemAttrs:{},attrs:{placeholder:"请输入",type:"textarea"},rules:[],prop:"remark",componentName:"ElInput",colAttrs:{span:24}}],rowAttrs:{gutter:20,justify:"start",align:"middle"},model:{}});let d=f;const I=()=>{J().then(e=>{s.deptOptions=e.data})},D=()=>{z("sys.user.initPassword").then(e=>{s.initPassword=e.msg}),S(d.id).then(e=>{l.value.model=e.data,s.postOptions=e.posts,s.roleOptions=e.roles,l.value.password||(l.value.model.password=s.initPassword),l.value.model.areaType=j(e.data.areaType)})};_(()=>d.modelValue,e=>{u.value=e,d.id&&e?(D(),I()):!d.id&&e&&(I(),l.value.model={sex:"1"})},{immediate:!0});const m=()=>{i("update:modelValue",!1)};return _(()=>u.value,e=>{e||m()}),(e,t)=>{const U=r("el-cascader"),h=r("el-option"),v=r("el-select"),q=r("ElementEasyForm"),y=r("el-button"),F=r("ComDialog");return p(),c(F,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=a=>u.value=a),width:$(R),title:f.id?"编辑":"新增"},{footer:o(()=>[W("div",null,[n(y,{size:"large",onClick:m},{default:o(()=>t[4]||(t[4]=[E("取消")])),_:1}),n(y,{size:"large",loading:P.value,type:"primary",onClick:x},{default:o(()=>t[5]||(t[5]=[E("保存")])),_:1},8,["loading"])])]),default:o(()=>[n(q,{ref_key:"comFromRef",ref:b,formJson:l.value},{deptId:o(()=>[n(U,{class:"w100",options:s.deptOptions,modelValue:l.value.model.deptId,"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.model.deptId=a),props:{value:"id",emitPath:!1,checkStrictly:!0},clearable:""},null,8,["options","modelValue"])]),postIds:o(()=>[n(v,{class:"w100",modelValue:l.value.model.postIds,"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.model.postIds=a),multiple:"",placeholder:"请选择岗位"},{default:o(()=>[(p(!0),A(C,null,k(s.postOptions,a=>(p(),c(h,{key:a.postId,label:a.postName,value:a.postId,disabled:a.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),roleIds:o(()=>[n(v,{class:"w100",modelValue:l.value.model.roleIds,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.model.roleIds=a),multiple:"",placeholder:"请选择岗位"},{default:o(()=>[(p(!0),A(C,null,k(s.roleOptions,a=>(p(),c(h,{key:a.roleId,label:a.roleName,value:a.roleId,disabled:a.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["formJson"])]),_:1},8,["modelValue","width","title"])}}});export{te as _};
