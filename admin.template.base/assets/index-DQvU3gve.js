import"./vue-CVNGtIj_.js";import{u as O,a as z}from"./vue-router-D7bIofKn.js";import H from"./deptTree-CkpZPD4T.js";import{f as K,r as G}from"./index-DkSUJrfs.js";import{_ as Q}from"./index-Bzhtb0e2.js";import{_ as J}from"./AllRight.vue_vue_type_script_setup_true_lang-DR0_80Hd.js";import{_ as W}from"./addOrEdit.vue_vue_type_script_setup_true_lang-Bajq81nw.js";import{d as X,e as Y,l as Z,f as ee,r as te}from"./user-DbH5c5QD.js";import{b as ae}from"./config-CytV5nq9.js";import{c as h,a as f}from"./element-plus-CvdjtRA4.js";import{d as re,i as v,b as w,r as d,j as r,c as oe,a as k,k as t,l as o,u as C,A as n,o as se,n as ne}from"./@vue-4wuvJO_G.js";import"./axios-CdcsOsvR.js";import"./vuex-CDsxXceG.js";import"./js-cookie-Cz0CWeBA.js";import"./path-browserify-D3uKt2uU.js";import"./vue-i18n-Bt9z2wfA.js";import"./@intlify-fCQYzvHO.js";import"./@vueuse-g1uILd_S.js";import"./element-easy-print-IlIR9WEy.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-BhhoUBD4.js";import"./element-easy-form-j6O3PxFI.js";import"./vuedraggable-C23OG9zM.js";import"./sortablejs-C1wvN1Nu.js";import"./@vue-monaco-CTUC9hHy.js";import"./uuid-CQkTLCs1.js";import"./nprogress-C1nr5Arz.js";import"./@element-plus-DtKFL0Hn.js";/* empty css                    */import"./dayjs-CuLmuTop.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";import"./drawer-DhJz5xdP.js";import"./detail.vue_vue_type_script_setup_true_name_userDetail_lang-Dunhl9HP.js";import"./detail-Bex21FUx.js";const le={class:"commonBoxmp"},ie={class:"aic h100"},ue={class:"jcb aic w100"},Ze=re({__name:"index",setup(de){O(),z();const{parseTime:pe,addDateRange:me,getDict:I}=K();let y=v({sys_job_status:[]});w(async()=>{y.sys_job_status=await I("sys_job_status")}),d(),d(!0);const _=d(!1),u=d(""),p=d(!1),T=e=>{u.value=e.userId,_.value=!0},g=v({initPassword:"",height:0,deptOptions:[],form:{},rules:{userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:2,max:20,message:"用户名称长度必须介于 2 和 20 之间",trigger:"blur"}],nickName:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]},dateRange:[],postOptions:[],roleOptions:[],tableData:[],userVisible:!1,columnData:[{label:"用户名称",prop:"userName",render:({row:e})=>t(r("el-link"),{type:"primary",onClick:()=>T(e)},{default:()=>[e.userName]}),visible:!0,renderHeader:({column:e})=>t(r("filterBox"),{title:e.label,valueKey:e.property,flterType:"input",onChange:s.value.handleFilterBox,data:s.value.formFilter},null)},{label:"用户昵称",prop:"nickName",visible:!0,renderHeader:({column:e})=>t(r("filterBox"),{title:e.label,valueKey:e.property,flterType:"input",onChange:s.value.handleFilterBox,data:s.value.formFilter},null)},{label:"部门",prop:"dept.deptName",visible:!0},{label:"手机号",prop:"phonenumber",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>t(Q,{values:e.status,dataType:"primary",options:y.sys_job_status,onClick:()=>U(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],operation:{label:"操作",prop:"操作",width:"180",fixed:"right",visible:!0,render:({row:e})=>t("div",null,[t(r("el-button"),{type:"primary",size:"small"},{default:()=>[n("编辑")]}),t(r("el-button"),{type:"danger",size:"small"},{default:()=>[n("删除")]})])},loading:!1}),m=v({pageNum:1,pageSize:10,deptId:void 0}),V=()=>{m.pageNum=1;const e=C(m);s.value.getList(e)},N=e=>{m.deptId=e.id,V()},B=()=>{u.value="",p.value=!0},s=d(),U=e=>{let a=e.status==="0"?"启用":"停用";h.confirm('确认要"'+a+'""'+e.userName+'"用户吗？').then(function(){const l={userId:e.userId,status:e.status};return Y(l)}).then(()=>{f.success(a+"成功"),s.value.getList()}).catch(function(){})},D=e=>{const a=e.userId;h.confirm('是否确认删除用户编号为"'+a+'"的数据项？').then(function(){return ee(a)}).then(()=>{c(),f.success("删除成功")}).catch(function(){})},P=e=>{u.value=String(e.userId),console.log("userId :>> ",u),ne(()=>{p.value=!0})},F=e=>{console.log("row :>> ",e),h.prompt("请输入新的密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:a})=>{te({userId:e.userId,password:e.value}).then(l=>{f({type:"success",message:"更新成功"}),c()})}).catch(()=>{f({type:"info",message:"Input canceled"})})},j=(e,a)=>{switch(e){case"updatePwd":F(a);break;case"updaterole":R(a);break}},R=e=>{const a=e.userId;G("/system/user-auth/role/"+a)},c=()=>{s.value.getList()},$=()=>{X().then(e=>{g.deptOptions=e.data})};return w(()=>{ae("sys.user.initPassword").then(e=>{g.initPassword=e.msg}),c(),$()}),(e,a)=>{const l=r("el-button"),S=r("arrow-down"),q=r("el-icon"),x=r("el-dropdown-item"),A=r("el-dropdown-menu"),E=r("el-dropdown"),L=r("el-table-column"),M=r("TableV2");return se(),oe("div",le,[k("div",ie,[t(H,{style:{"margin-right":"10px"},onUpdateDept:N}),t(M,{apiFunction:C(Z),class:"flex1",isInit:!1,filter:{...m},ref_key:"tableV2Ref",ref:s,columns:g.columnData},{tableHeader:o(()=>[k("div",ue,[t(l,{type:"primary",onClick:B},{default:o(()=>[n("添加用户")]),_:1})])]),operation:o(()=>[t(L,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:o(i=>[t(l,{type:"text",onClick:b=>P(i.row)},{default:o(()=>[n("修改")]),_:2},1032,["onClick"]),t(l,{type:"text",onClick:b=>D(i.row)},{default:o(()=>[n("删除")]),_:2},1032,["onClick"]),t(E,{onCommand:b=>j(b,i.row)},{dropdown:o(()=>[t(A,null,{default:o(()=>[t(x,{command:"updatePwd"},{default:o(()=>[n("更换密码")]),_:1}),t(x,{command:"updaterole"},{default:o(()=>[n("分配角色")]),_:1})]),_:1})]),default:o(()=>[t(l,{class:"ml10",type:"text"},{default:o(()=>[n(" 更多 "),t(q,{class:"el-icon--right"},{default:o(()=>[t(S)]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["apiFunction","filter","columns"])]),t(J,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=i=>_.value=i),id:u.value},null,8,["modelValue","id"]),t(W,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=i=>p.value=i),id:u.value,onUpdate:c},null,8,["modelValue","id"])])}}});export{Ze as default};
