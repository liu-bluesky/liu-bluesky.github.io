import"./vue-Brcqt2vG.js";import{u as L,b as M}from"./vue-router-C7rU-wsU.js";import{h as m,p as S,f as H}from"./index-DI19To0g.js";import{_ as K}from"./index-BN6k9vM8.js";import{a as g,c as P}from"./element-plus-DELVhQcd.js";import{d as z,A as k,b as N,r as v,j as o,i as n,o as C,c as G,k as l,a as D,q as i,u as J,m as Q,x as W}from"./@vue-B5Rjg0tc.js";import"./axios-CdcsOsvR.js";import"./pinia-6dDT7uVM.js";import"./vue-demi-CP2SMu8c.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-q0Sksrg4.js";import"./vue-i18n-oCxI6G6S.js";import"./@intlify-D_0T6EgR.js";/* empty css                    */import"./dayjs-CuLmuTop.js";import"./element-easy-print-DJ-KPX5f.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-CGqamrhd.js";import"./element-easy-form-Cpih-KE2.js";import"./vuedraggable-9s6OmZnz.js";import"./@vue-monaco-BfCDpgCA.js";import"./uuid-CQkTLCs1.js";import"./@element-plus-CMMVBHN7.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";function w(s){return m.request({url:"/system/dept/list",method:"get",params:s})}function X(s){return m.request({url:"/system/dept/list/exclude/"+s,method:"get"})}function Y(s){return m.request({url:"/system/dept/"+s,method:"get"})}function Z(s){return m.request({url:"/system/dept",method:"post",data:s})}function ee(s){return m.request({url:"/system/dept",method:"put",data:s})}function te(s){return m.request({url:"/system/dept/"+s,method:"delete"})}const oe={class:"commonBoxmp"},le={class:"jcb aic w100"},re={class:"dialog-footer"},$e=z({__name:"index",setup(s){L(),M();const{parseTime:ae,addDateRange:se,handleTree:y,getDict:q}=H();let I=k({sys_job_status:[]});N(async()=>{I.sys_job_status=await q("sys_job_status")});const h=v(),e=k({typeOptions:[],form:{},title:"",rules:{dictLabel:[{required:!0,message:"数据标签不能为空",trigger:"blur"}],dictValue:[{required:!0,message:"数据键值不能为空",trigger:"blur"}],dictSort:[{required:!0,message:"数据顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],deptOptions:[],columnData:[{label:"部门名称",prop:"deptName",visible:!0},{label:"排序",prop:"orderNum",visible:!0},{label:"备注",prop:"remark",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:a})=>o(K,{values:a.status,dataType:"primary",options:I.sys_job_status},null)},{label:"创建时间",prop:"createTime"}],loading:!1,defaultDictType:""}),R=a=>{a&&(e.form.parentId=a[a.length-1])},T=async a=>{a&&(await a.validate(),e.form.parentId&&Array.isArray(e.form.parentId)&&(e.form.parentId=e.form.parentId[e.form.parentId.length-1]),e.form.deptId!=null?ee(e.form).then(t=>{g.success("修改成功"),e.userVisible=!1,f()}):Z(e.form).then(t=>{g.success("新增成功"),e.userVisible=!1,f()}))},U=a=>{const t=a.deptId;P.confirm('是否确认删除编号为"'+a.deptName+'"的数据项？').then(function(){return te(t)}).then(()=>{g.success("删除成功"),f()}).catch(function(){})},O=a=>{const t=a.deptId;Y(t).then(d=>{e.title="修改部门",e.form=d.data,e.userVisible=!0,X(a.deptId).then(b=>{if(e.deptOptions=y(b.data,"deptId"),e.deptOptions.length==0){const V={deptId:e.form.parentId,deptName:e.form.parentName,children:[]};e.deptOptions.push(V)}})})},j=()=>{w().then(a=>{e.deptOptions=y(a.data,"deptId")}),e.form={},e.title="新增部门",e.userVisible=!0},f=()=>{h.value.getList()},x=v();return N(()=>{f()}),(a,t)=>{const d=n("el-button"),b=n("el-table-column"),V=n("TableV2"),B=n("el-cascader"),p=n("el-form-item"),u=n("el-col"),c=n("el-row"),_=n("el-input"),F=n("el-input-number"),$=n("el-form"),A=n("el-dialog");return C(),G("div",oe,[o(V,{apiFunction:J(w),class:"flex1",dataKey:"data",ref_key:"tableV2Ref",ref:h,columns:e.columnData},{tableHeader:l(()=>[D("div",le,[o(d,{type:"primary",onClick:j},{default:l(()=>t[10]||(t[10]=[i("添加部门")])),_:1})])]),operation:l(()=>[o(b,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:l(r=>[o(d,{type:"text",onClick:E=>O(r.row)},{default:l(()=>t[11]||(t[11]=[i("修改")])),_:2},1032,["onClick"]),o(d,{type:"text",onClick:E=>U(r.row)},{default:l(()=>t[12]||(t[12]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),o(A,{modelValue:e.userVisible,"onUpdate:modelValue":t[9]||(t[9]=r=>e.userVisible=r),title:e.title,width:"50%","destroy-on-close":"",center:""},{footer:l(()=>[D("span",re,[o(d,{onClick:t[7]||(t[7]=r=>e.userVisible=!1)},{default:l(()=>t[13]||(t[13]=[i("取消")])),_:1}),o(d,{type:"primary",onClick:t[8]||(t[8]=r=>T(x.value))},{default:l(()=>t[14]||(t[14]=[i(" 确定 ")])),_:1})])]),default:l(()=>[o($,{ref_key:"ruleFormRef",ref:x,model:e.form,rules:e.rules,"label-width":"120px",class:"demo-ruleForm"},{default:l(()=>[o(c,{gutter:20},{default:l(()=>[e.form.parentId!==0?(C(),Q(u,{key:0,span:24},{default:l(()=>[o(p,{label:"上级部门"},{default:l(()=>[o(B,{options:e.deptOptions,modelValue:e.form.parentId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.parentId=r),class:"w100",props:{checkStrictly:!0,emitPath:!1,value:"deptId",label:"deptName"},clearable:"",onChange:R},null,8,["options","modelValue"])]),_:1})]),_:1})):W("",!0)]),_:1}),o(c,{gutter:20},{default:l(()=>[o(u,{span:12},{default:l(()=>[o(p,{label:"部门名称",prop:"deptName"},{default:l(()=>[o(_,{modelValue:e.form.deptName,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.deptName=r),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),o(u,{span:12},{default:l(()=>[o(p,{label:"显示排序",prop:"orderNum"},{default:l(()=>[o(F,{modelValue:e.form.orderNum,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.orderNum=r),min:0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(c,{gutter:20},{default:l(()=>[o(u,{span:12},{default:l(()=>[o(p,{label:"负责人",prop:"leader"},{default:l(()=>[o(_,{modelValue:e.form.leader,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.leader=r),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),o(u,{span:12},{default:l(()=>[o(p,{label:"联系电话",prop:"phone"},{default:l(()=>[o(_,{modelValue:e.form.phone,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.phone=r),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(c,{gutter:20},{default:l(()=>[o(u,{span:12},{default:l(()=>[o(p,{label:"状态"},{default:l(()=>[o(S,{class:"w100",deptId:"sys_normal_disable",modelValue:e.form.status,"onUpdate:modelValue":t[5]||(t[5]=r=>e.form.status=r)},null,8,["modelValue"])]),_:1})]),_:1}),o(u,{span:12},{default:l(()=>[o(p,{label:"邮箱",prop:"email"},{default:l(()=>[o(_,{modelValue:e.form.email,"onUpdate:modelValue":t[6]||(t[6]=r=>e.form.email=r),maxlength:"50",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{$e as default};
