import"./vue-BM9Tihka.js";import{u as J,a as K}from"./vue-router-EuJPeoHv.js";import{h as O,f as P,o as N}from"./index-CEe7SyIl.js";import{_ as T}from"./index-XdjtvRwH.js";import{d as G,r as V,A as c,b as Q,u as b,i as m,c as v,j as e,k as t,o as g,a as q,am as R,q as n,v as u,x as z,m as A}from"./@vue-BKq3Py-p.js";import"./axios-CdcsOsvR.js";import"./vuex-B5FhxtE1.js";import"./js-cookie-Cz0CWeBA.js";import"./path-browserify-D3uKt2uU.js";import"./vue-i18n-CykCSAY5.js";import"./@intlify-fCQYzvHO.js";import"./@vueuse-CeKbzKoz.js";import"./nprogress-C1nr5Arz.js";import"./element-plus-BPBmY4gL.js";import"./lodash-es-CiJSjksT.js";import"./@element-plus-DrU0i_Rz.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-CuLmuTop.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";/* empty css                    */import"./element-easy-print-DysYZfHv.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-CxtjGOry.js";import"./element-easy-form-CSO3c5CP.js";import"./vuedraggable-DBgj9TYl.js";import"./sortablejs-C1wvN1Nu.js";import"./@vue-monaco-Ff2YEyYt.js";import"./uuid-CQkTLCs1.js";function E(j){return O.request({url:"/monitor/jobLog/list",method:"get",params:j})}const W={class:"commonBoxmp"},X={class:"jcb aic w100"},Y={key:0},Z={key:1},ee={class:"dialog-footer"},Se=G({__name:"log",setup(j){J();const h=K(),{parseTime:D,addDateRange:te,getDict:w,selectDictLabel:I}=P(),L=(i,l)=>I(_.sys_job_group,i.businessType);V(!0);const o=c({form:{},title:"",rules:{postName:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}],postCode:[{required:!0,message:"岗位编码不能为空",trigger:"blur"}],postSort:[{required:!0,message:"岗位顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"日志编号",prop:"jobLogId",visible:!0},{label:"任务名称",prop:"jobName",visible:!0},{label:"任务组名",prop:"jobGroup",render:({row:i})=>e(T,{values:i.jobGroup,options:_.sys_job_group},null)},{label:"调用目标字符串",prop:"invokeTarget",visible:!0},{label:"日志信息",prop:"jobMessage",visible:!0},{label:"执行状态",render:({row:i})=>e(T,{values:i.status,options:_.sys_common_status},null),prop:"status",visible:!0},{label:"执行时间",prop:"createTime",visible:!0}],loading:!1});c({currentPage:1,total:10,pageSize:10,pageSizes:[10,20,30,40],layout:"total, prev, pager, next,sizes"});let k={pageNum:1,pageSize:10};const s=c(JSON.parse(JSON.stringify(k))),y=V(),d=()=>{s.pageNum=1;let i=b(s);y.value.getList(i)},S=()=>{Object.assign(s,k),d()},U=i=>{o.form=i,o.userVisible=!0};let _=c({sys_job_group:[],sys_common_status:[]});return V(),Q(async()=>{_.sys_job_group=await w("sys_job_group"),_.sys_common_status=await w("sys_common_status");const i=h.params&&h.params.jobId;if(i){s.jobId=i;let l=b(s);y.value.getList(l)}}),(i,l)=>{const x=m("el-input"),a=m("el-form-item"),M=m("el-date-picker"),f=m("el-button"),C=m("el-form"),B=m("el-table-column"),F=m("TableV2"),p=m("el-col"),$=m("el-row"),H=m("el-dialog");return g(),v("div",W,[e(F,{class:"flex1",isInit:!1,ref_key:"tableV2Ref",ref:y,apiFunction:b(E),selection:"",columns:o.columnData},{tableHeader:t(()=>[q("div",X,[e(C,{model:s,ref:"queryForm",size:"small",inline:!0},{default:t(()=>[e(a,{label:"系统模块",prop:"title"},{default:t(()=>[e(x,{modelValue:s.title,"onUpdate:modelValue":l[0]||(l[0]=r=>s.title=r),placeholder:"请输入系统模块",clearable:"",style:{width:"240px"},onKeyup:R(d,["enter","native"])},null,8,["modelValue"])]),_:1}),e(a,{label:"操作人员",prop:"operName"},{default:t(()=>[e(x,{modelValue:s.operName,"onUpdate:modelValue":l[1]||(l[1]=r=>s.operName=r),placeholder:"请输入操作人员",clearable:"",style:{width:"240px"},onKeyup:R(d,["enter","native"])},null,8,["modelValue"])]),_:1}),e(a,{label:"类型",prop:"businessType"},{default:t(()=>[e(N,{modelValue:s.businessType,"onUpdate:modelValue":l[2]||(l[2]=r=>s.businessType=r),class:"w100",onChange:d,placeholder:"操作类型",dictCode:"sys_job_group"},null,8,["modelValue"])]),_:1}),e(a,{label:"状态",prop:"status"},{default:t(()=>[e(N,{modelValue:s.status,"onUpdate:modelValue":l[3]||(l[3]=r=>s.status=r),class:"w100",onChange:d,placeholder:"操作状态",dictCode:"sys_common_status"},null,8,["modelValue"])]),_:1}),e(a,{label:"操作时间"},{default:t(()=>[e(M,{modelValue:o.dateRange,"onUpdate:modelValue":l[4]||(l[4]=r=>o.dateRange=r),style:{width:"240px"},"value-format":"yyyy-MM-dd HH:mm:ss",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),e(a,null,{default:t(()=>[e(f,{type:"primary",size:"mini",onClick:d},{default:t(()=>[n("搜索")]),_:1}),e(f,{size:"mini",onClick:S},{default:t(()=>[n("重置")]),_:1})]),_:1})]),_:1},8,["model"])])]),operation:t(()=>[e(B,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:t(r=>[e(f,{type:"text",onClick:oe=>U(r.row)},{default:t(()=>[n("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),e(H,{modelValue:o.userVisible,"onUpdate:modelValue":l[6]||(l[6]=r=>o.userVisible=r),title:"操作日志详细",width:"50%","destroy-on-close":"",center:""},{footer:t(()=>[q("span",ee,[e(f,{onClick:l[5]||(l[5]=r=>o.userVisible=!1)},{default:t(()=>[n("取消")]),_:1})])]),default:t(()=>[e(C,{ref:"form",model:o.form,"label-width":"100px",size:"mini"},{default:t(()=>[e($,null,{default:t(()=>[e(p,{span:12},{default:t(()=>[e(a,{label:"操作模块："},{default:t(()=>[n(u(o.form.title)+" / "+u(L(o.form)),1)]),_:1}),e(a,{label:"登录信息："},{default:t(()=>[n(u(o.form.operName)+" / "+u(o.form.operIp)+" / "+u(o.form.operLocation),1)]),_:1})]),_:1}),e(p,{span:12},{default:t(()=>[e(a,{label:"请求地址："},{default:t(()=>[n(u(o.form.operUrl),1)]),_:1}),e(a,{label:"请求方式："},{default:t(()=>[n(u(o.form.requestMethod),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"操作方法："},{default:t(()=>[n(u(o.form.method),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"请求参数："},{default:t(()=>[n(u(o.form.operParam),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"返回参数："},{default:t(()=>[n(u(o.form.jsonResult),1)]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(a,{label:"操作状态："},{default:t(()=>[o.form.status===0?(g(),v("div",Y,"正常")):o.form.status===1?(g(),v("div",Z,"失败")):z("",!0)]),_:1})]),_:1}),e(p,{span:8},{default:t(()=>[e(a,{label:"消耗时间："},{default:t(()=>[n(u(o.form.costTime)+"毫秒",1)]),_:1})]),_:1}),e(p,{span:10},{default:t(()=>[e(a,{label:"操作时间："},{default:t(()=>[n(u(b(D)(o.form.operTime)),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[o.form.status===1?(g(),A(a,{key:0,label:"异常信息："},{default:t(()=>[n(u(o.form.errorMsg),1)]),_:1})):z("",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Se as default};
