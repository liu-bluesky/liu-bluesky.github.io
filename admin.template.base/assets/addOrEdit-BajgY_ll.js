import"./vue-BCJY8gBf.js";import{d as F,e as J,g as P}from"./role-DQhvBjKq.js";import{t as U,v as q,a as j}from"./index-DnKBT612.js";import{t as z,r as L}from"./menu-CI36NPAS.js";import{u as H}from"./vue-i18n-DkRB_xiH.js";import{a as N}from"./element-plus-BIk4sW6s.js";import{d as W,s as V,r as g,B as G,w as I,j as u,o as Q,q as X,l as s,a as k,k as n,v as i,u as Y,n as x}from"./@vue-BwKUEgJD.js";import"./axios-DWt2DAqT.js";import"./vue-router-Bk-12vT2.js";import"./pinia-TB7j859w.js";import"./vue-demi-DP18qiWf.js";import"./@vueuse-BO9Bf6Jf.js";import"./js-cookie-C1NIBS1L.js";/* empty css                    */import"./dayjs-CpORZXld.js";import"./element-easy-print-DsNlMTPy.js";import"./mockjs-CpzBLoCE.js";import"./lodash-Ce2coQ-v.js";import"./vue3-draggable-resizable-yn-CG0QmAMT.js";import"./element-easy-form-CUlqWkgt.js";import"./vuedraggable-BjUjsGh2.js";import"./@vue-monaco-B0CNy8YX.js";import"./uuid-CQkTLCs1.js";import"./@element-plus-D9bzjPyL.js";import"./lodash-es-D0ldFxdg.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-riLredlm.js";import"./async-validator-BxgltDpX.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-uXSQws5g.js";import"./@intlify-BnZ-SFqO.js";const Z=W({__name:"addOrEdit",props:{modelValue:{type:Boolean,defalut:!1},id:{type:String,defalut:""}},emits:["update:modelValue","update"],setup(v,{emit:A}){const{t:C}=H(),h=A,c=V(!1),w=V(!1),b=g(),O=()=>{let t=d.value.getCheckedKeys(),e=d.value.getHalfCheckedKeys();return t.unshift.apply(t,e),t},K=async()=>{try{const t=await b.value.validate();a.value.model.menuIds=O(),m.id?F(t).then(e=>{N.success(C("操作成功")),f(),h("update")}):J(t).then(e=>{N.success(C("操作成功")),f(),h("update")})}catch(t){console.log("error :>> ",t)}},l=G({menuOptions:[],menuExpand:!1,menuNodeAll:!1}),a=g({rowAttrs:{gutter:20,justify:"start",align:"middle"},schema:[{label:"角色名称",prop:"roleName",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请输入"},rules:[{required:!0,message:"不能为空",trigger:"change"}]},{label:"权限字符",prop:"roleKey",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请选择"},rules:[{required:!1,message:"不能为空",trigger:"change"}]},{label:"角色顺序",prop:"roleSort",colAttrs:{span:12},componentName:"ElInputNumber",attrs:{placeholder:"请输入",precision:2,"controls-position":"right",...q}},{label:"邮箱",prop:"email",colAttrs:{span:12},componentName:"ElInput",attrs:{type:"number",placeholder:"请选择"}},{label:"用户名称",prop:"userName",colAttrs:{span:12},componentName:"ElInput",hidden:{matchPattern:"&&",dataSelect:[],type:"function",value:!1,dataJs:(t,e)=>e.userId!=null},attrs:{placeholder:"请输入"}},{label:"状态",prop:"status",colAttrs:{span:12},componentName:"selectDict",attrs:{dictCode:"sys_normal_disable",placeholder:"请选择",showPassword:!0}},{label:"菜单权限",prop:"menuIds",colAttrs:{span:12},componentName:"ElInput",attrs:{}},{label:"备注",type:"COMPONENT",formItemAttrs:{},attrs:{placeholder:"请输入",type:"textarea"},rules:[],prop:"remark",componentName:"ElInput",colAttrs:{span:24}}],model:{}});let m=v;const d=g(),R=()=>{z().then(t=>{l.menuOptions=t.data})},T=()=>{const t=M(m.id);P(m.id).then(e=>{a.value.model=e.data,x(()=>{t.then(r=>{r.checkedKeys.forEach(y=>{x(()=>{d.value.setChecked(y,!0,!1)})})})})})},M=t=>L(t).then(e=>(l.menuOptions=e.menus,e));I(()=>m.modelValue,t=>{c.value=t,m.id&&t?T():!m.id&&t&&(R(),a.value.model={})},{immediate:!0});const _=(t,e)=>{{let r=l.menuOptions;for(let p=0;p<r.length;p++)d.value.store.nodesMap[r[p].id].expanded=t}},S=(t,e)=>{d.value.setCheckedNodes(t?l.menuOptions:[])},B=(t,e)=>{a.value.model.menuCheckStrictly=!!t},f=()=>{h("update:modelValue",!1)};return I(()=>c.value,t=>{t||f()}),(t,e)=>{const r=u("el-checkbox"),p=u("el-tree"),y=u("ElementEasyForm"),E=u("el-button"),D=u("ComDialog");return Q(),X(D,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=o=>c.value=o),width:Y(U),title:v.id?"编辑":"新增"},{footer:s(()=>[k("div",null,[n(E,{size:"large",onClick:f},{default:s(()=>e[10]||(e[10]=[i("取消")])),_:1}),n(E,{size:"large",loading:w.value,type:"primary",onClick:K},{default:s(()=>e[11]||(e[11]=[i("保存")])),_:1},8,["loading"])])]),default:s(()=>[n(y,{ref_key:"comFromRef",ref:b,formJson:a.value},{menuIds:s(()=>[k("div",null,[k("div",null,[n(r,{modelValue:l.menuExpand,"onUpdate:modelValue":e[0]||(e[0]=o=>l.menuExpand=o),onChange:e[1]||(e[1]=o=>_(o,"menu"))},{default:s(()=>e[7]||(e[7]=[i("展开/折叠")])),_:1},8,["modelValue"]),n(r,{modelValue:l.menuNodeAll,"onUpdate:modelValue":e[2]||(e[2]=o=>l.menuNodeAll=o),onChange:e[3]||(e[3]=o=>S(o,"menu"))},{default:s(()=>e[8]||(e[8]=[i("全选/全不选")])),_:1},8,["modelValue"]),n(r,{modelValue:a.value.model.menuCheckStrictly,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.model.menuCheckStrictly=o),onChange:e[5]||(e[5]=o=>B(o,"menu"))},{default:s(()=>e[9]||(e[9]=[i("父子联动")])),_:1},8,["modelValue"])]),n(p,{class:"tree-border",data:l.menuOptions,"show-checkbox":"",ref_key:"treeRef",ref:d,"node-key":"id","check-strictly":!a.value.model.menuCheckStrictly,"empty-text":"加载中，请稍候",props:l.defaultProps},null,8,["data","check-strictly","props"])])]),_:1},8,["formJson"])]),_:1},8,["modelValue","width","title"])}}}),Re=j(Z,[["__file","D:/work/public/admin-tempalte-base/src/views/system/role/component/addOrEdit.vue"]]);export{Re as default};
