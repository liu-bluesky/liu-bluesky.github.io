import"./vue-Brcqt2vG.js";import{u as A,b as B}from"./vue-router-C7rU-wsU.js";import E from"./selectUser-BWXQ5ZBJ.js";import{_ as O}from"./index-BN6k9vM8.js";import{f as j}from"./index-CkSRKYAj.js";import{a as x,b as F,c as K}from"./role-CIYMOrXE.js";import{c as L,a as h}from"./element-plus-DELVhQcd.js";import{d as P,r as v,A as d,j as r,b as V,u as c,i as s,o as M,c as $,k as a,a as J,am as U,q as f}from"./@vue-B5Rjg0tc.js";import"./axios-CdcsOsvR.js";import"./pinia-6dDT7uVM.js";import"./vue-demi-CP2SMu8c.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-q0Sksrg4.js";import"./vue-i18n-oCxI6G6S.js";import"./@intlify-D_0T6EgR.js";/* empty css                    */import"./dayjs-CuLmuTop.js";import"./element-easy-print-DJ-KPX5f.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-CGqamrhd.js";import"./element-easy-form-Cb_zU3ED.js";import"./lodash-CcF5vdS9.js";import"./vuedraggable-9s6OmZnz.js";import"./@vue-monaco-BfCDpgCA.js";import"./uuid-CQkTLCs1.js";import"./@element-plus-CMMVBHN7.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";const Q={class:"commonBoxmp"},G={class:"jcb aic w100"},qe=P({__name:"authUser",setup(H){A();const b=B(),{parseTime:W,addDateRange:X,getDict:k}=j(),_=v(),m=d({openDataScope:!1,defaultProps:{children:"children",label:"label"},menuOptions:[],deptOptions:[],deptExpand:!1,deptNodeAll:!1,menuExpand:!1,menuNodeAll:!1,title:"",form:{},userVisible:!1,rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"用户名称",visible:!0,prop:"userName"},{label:"用户昵称",visible:!0,prop:"nickName"},{label:"邮箱",visible:!0,prop:"email"},{label:"手机",prop:"phonenumber",visible:!0},{label:"状态",visible:!0,prop:"status",render:({row:o})=>r(O,{values:o.status,dataType:"primary",options:N.sys_normal_disable},null)},{label:"创建时间",visible:!0,prop:"createTime"}],loading:!1}),g=d({currentPage:1,total:10,pageSize:10,pageSizes:[10,20,30,40],layout:"total, prev, pager, next,sizes"}),I={pageNum:1,pageSize:10,userName:"",phonenumber:""},t=d(JSON.parse(JSON.stringify(I))),p=()=>{t.pageNum=1;let o=c(t);_.value.getList(o)},S=()=>{Object.assign(t,I),p()},w=o=>{const e=t.roleId;L.confirm('确认要取消该用户"'+o.userName+'"角色吗？').then(function(){return F({userId:o.userId,roleId:e})}).then(()=>{h.success("取消授权成功")}).catch(function(){})};let y=v();const z=()=>{y.value.show()},C=()=>{m.loading=!0,t.pageNum=g.currentPage,t.pageSize=g.pageSize,x(t).then(o=>{m.tableData=o.rows,g.total=o.total,m.loading=!1})};v();const R=o=>{const e=t.roleId,n=o.ids.join(",");if(n==""){h.error("请选择要分配的用户");return}K({roleId:e,userIds:n}).then(l=>{h.success(l.msg),l.code===200&&y.value.hide()})};let N=d({sys_normal_disable:[]});return V(async()=>{N.sys_normal_disable=await k("sys_normal_disable"),C()}),V(()=>{const o=b.params&&b.params.roleId;if(o){t.roleId=o;let e=c(t);_.value.getList(e)}}),(o,e)=>{const n=s("el-input"),l=s("el-form-item"),u=s("el-button"),q=s("el-form"),D=s("el-table-column"),T=s("TableV2");return M(),$("div",Q,[r(T,{class:"flex1",apiFunction:c(x),ref_key:"tableV2Ref",ref:_,columns:m.columnData},{tableHeader:a(()=>[J("div",G,[r(q,{model:t,ref:"queryForm",size:"small",inline:!0},{default:a(()=>[r(l,{label:"用户名称",prop:"userName"},{default:a(()=>[r(n,{modelValue:t.userName,"onUpdate:modelValue":e[0]||(e[0]=i=>t.userName=i),placeholder:"请输入用户名称",clearable:"",style:{width:"240px"},onKeyup:U(p,["enter","native"])},null,8,["modelValue"])]),_:1}),r(l,{label:"手机号码",prop:"phonenumber"},{default:a(()=>[r(n,{modelValue:t.phonenumber,"onUpdate:modelValue":e[1]||(e[1]=i=>t.phonenumber=i),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:U(p,["enter","native"])},null,8,["modelValue"])]),_:1}),r(l,null,{default:a(()=>[r(u,{type:"primary",size:"mini",onClick:p},{default:a(()=>e[2]||(e[2]=[f("搜索")])),_:1}),r(u,{size:"mini",onClick:S},{default:a(()=>e[3]||(e[3]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"]),r(u,{type:"primary",onClick:z},{default:a(()=>e[4]||(e[4]=[f("添加用户")])),_:1})])]),operation:a(()=>[r(D,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:a(i=>[r(u,{type:"text",onClick:Y=>w(i.row)},{default:a(()=>e[5]||(e[5]=[f("取消授权")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),r(E,{ref_key:"selectUserRef",ref:y,onGetUsers:R,roleId:c(b).params.roleId},null,8,["roleId"])])}}});export{qe as default};
