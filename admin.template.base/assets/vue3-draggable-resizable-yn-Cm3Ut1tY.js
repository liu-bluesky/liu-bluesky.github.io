import{c as V,g as He}from"./ace-builds-DiBK84cm.js";import{r as ge}from"./vue-DSB24BnW.js";var ye={},fe={},E={},D={},me;function he(){if(me)return D;me=1;var b=V&&V.__assign||function(){return b=Object.assign||function(f){for(var r,t=1,s=arguments.length;t<s;t++){r=arguments[t];for(var v in r)Object.prototype.hasOwnProperty.call(r,v)&&(f[v]=r[v])}return f},b.apply(this,arguments)};D.__esModule=!0,D.getReferenceLineMap=D.getId=D.filterHandles=D.removeEvent=D.addEvent=D.getElSize=D.IDENTITY=void 0;var n=ze();D.IDENTITY=Symbol("Vue3DraggableResizable");function i(f){var r=window.getComputedStyle(f);return{width:parseFloat(r.getPropertyValue("width")),height:parseFloat(r.getPropertyValue("height"))}}D.getElSize=i;function d(f){return function(r,t,s){r&&(typeof t=="string"&&(t=[t]),t.forEach(function(v){return r[f](v,s,{passive:!1})}))}}D.addEvent=d("addEventListener"),D.removeEvent=d("removeEventListener");function p(f){if(f&&f.length>0){var r=[];return f.forEach(function(t){n.ALL_HANDLES.includes(t)&&!r.includes(t)&&r.push(t)}),r}else return[]}D.filterHandles=p;function h(){return String(Math.random()).substr(2)+String(Date.now())}D.getId=h;function A(f,r,t){var s,v;if(f.disabled.value)return null;var c={row:[],col:[]},_=r.parentWidth,e=r.parentHeight;(s=c.row).push.apply(s,f.adsorbRows),(v=c.col).push.apply(v,f.adsorbCols),f.adsorbParent.value&&(c.row.push(0,e.value,e.value/2),c.col.push(0,_.value,_.value/2));var a=f.getPositionStore(t);Object.values(a).forEach(function(u){var o=u.x,g=u.y,z=u.w,Y=u.h;c.row.push(g,g+Y,g+Y/2),c.col.push(o,o+z,o+z/2)});var l={row:c.row.reduce(function(u,o){var g;return b(b({},u),(g={},g[o]={min:o-5,max:o+5,value:o},g))},{}),col:c.col.reduce(function(u,o){var g;return b(b({},u),(g={},g[o]={min:o-5,max:o+5,value:o},g))},{})};return l}return D.getReferenceLineMap=A,D}var be;function Me(){if(be)return E;be=1;var b=V&&V.__assign||function(){return b=Object.assign||function(e){for(var a,l=1,u=arguments.length;l<u;l++){a=arguments[l];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},b.apply(this,arguments)};E.__esModule=!0,E.watchProps=E.initResizeHandle=E.initDraggableContainer=E.initLimitSizeAndMethods=E.initParent=E.initState=E.useState=void 0;var n=ge,i=he();function d(e){var a=n.ref(e),l=function(u){return a.value=u,u};return[a,l]}E.useState=d;function p(e,a){var l=d(e.initW),u=l[0],o=l[1],g=d(e.initH),z=g[0],Y=g[1],B=d(e.x),L=B[0],W=B[1],C=d(e.y),T=C[0],R=C[1],U=d(e.active),P=U[0],k=U[1],S=d(!1),ie=S[0],H=S[1],se=d(!1),oe=se[0],Z=se[1],G=d(""),re=G[0],ue=G[1],K=d(1/0),I=K[0],le=K[1],X=d(1/0),j=X[0],J=X[1],y=d(e.minW),O=y[0],ne=y[1],de=d(e.minH),ee=de[0],q=de[1],F=d(e.parentScaleX),x=F[0],m=F[1],M=d(e.parentScaleY),te=M[0],$=M[1],Q=d(e.triggerKey),N=Q[0],ae=Q[1],we=n.computed(function(){return z.value/u.value});return n.watch(u,function(w){a("update:w",w)},{immediate:!0}),n.watch(z,function(w){a("update:h",w)},{immediate:!0}),n.watch(T,function(w){a("update:y",w)}),n.watch(L,function(w){a("update:x",w)}),n.watch(P,function(w,ce){a("update:active",w),!ce&&w?a("activated"):ce&&!w&&a("deactivated")}),n.watch(function(){return e.active},function(w){k(w)}),n.watch(function(){return e.parentScaleX},function(){m(e.parentScaleX)}),n.watch(function(){return e.parentScaleY},function(){$(e.parentScaleY)}),n.watch(function(){return e.triggerKey},function(){ae(e.triggerKey)}),{id:i.getId(),width:u,height:z,top:T,left:L,enable:P,dragging:ie,resizing:oe,resizingHandle:re,resizingMaxHeight:j,resizingMaxWidth:I,resizingMinWidth:O,resizingMinHeight:ee,aspectRatio:we,parentScaleX:x,parentScaleY:te,triggerKey:N,setEnable:k,setDragging:H,setResizing:Z,setResizingHandle:ue,setResizingMaxHeight:J,setResizingMaxWidth:le,setResizingMinWidth:ne,setResizingMinHeight:q,$setWidth:function(w){return o(Math.floor(w))},$setHeight:function(w){return Y(Math.floor(w))},$setTop:function(w){return R(Math.floor(w))},$setLeft:function(w){return W(Math.floor(w))}}}E.initState=p;function h(e){var a=n.ref(0),l=n.ref(0);return n.onMounted(function(){if(e.value&&e.value.parentElement){var u=i.getElSize(e.value.parentElement),o=u.width,g=u.height;a.value=o,l.value=g}}),{parentWidth:a,parentHeight:l}}E.initParent=h;function A(e,a,l){var u=l.width,o=l.height,g=l.left,z=l.top,Y=l.resizingMaxWidth,B=l.resizingMaxHeight,L=l.resizingMinWidth,W=l.resizingMinHeight,C=l.$setWidth,T=l.$setHeight,R=l.$setTop,U=l.$setLeft,P=a.parentWidth,k=a.parentHeight,S={minWidth:n.computed(function(){return L.value}),minHeight:n.computed(function(){return W.value}),maxWidth:n.computed(function(){var H=1/0;return e.parent&&(H=Math.min(P.value,Y.value)),H}),maxHeight:n.computed(function(){var H=1/0;return e.parent&&(H=Math.min(k.value,B.value)),H}),minLeft:n.computed(function(){return e.parent?0:-1/0}),minTop:n.computed(function(){return e.parent?0:-1/0}),maxLeft:n.computed(function(){return e.parent?P.value-u.value:1/0}),maxTop:n.computed(function(){return e.parent?k.value-o.value:1/0})},ie={setWidth:function(H){return e.disabledW?u.value:C(Math.min(S.maxWidth.value,Math.max(S.minWidth.value,H)))},setHeight:function(H){return e.disabledH?o.value:T(Math.min(S.maxHeight.value,Math.max(S.minHeight.value,H)))},setTop:function(H){return e.disabledY?z.value:R(Math.min(S.maxTop.value,Math.max(S.minTop.value,H)))},setLeft:function(H){return e.disabledX?g.value:U(Math.min(S.maxLeft.value,Math.max(S.minLeft.value,H)))}};return b(b({},S),ie)}E.initLimitSizeAndMethods=A;var f=["mousedown","touchstart"],r=["mouseup","touchend"],t=["mousemove","touchmove"];function s(e){return"touches"in e?[e.touches[0].pageX,e.touches[0].pageY]:[e.pageX,e.pageY]}function v(e,a,l,u,o,g,z){var Y=a.left,B=a.top,L=a.width,W=a.height,C=a.dragging,T=a.id,R=a.setDragging,U=a.setEnable,P=a.setResizing,k=a.setResizingHandle,S=a.parentScaleX,ie=a.parentScaleY,H=a.triggerKey,se=l.setTop,oe=l.setLeft,Z=0,G=0,re=0,ue=0,K=null,I=document.documentElement,le=function(y){var O,ne=y.target;!((O=e.value)===null||O===void 0)&&O.contains(ne)||(U(!1),R(!1),P(!1),k(""))},X=function(){R(!1),i.removeEvent(I,r,X),i.removeEvent(I,t,j),K=null,g&&(g.updatePosition(T,{x:Y.value,y:B.value,w:L.value,h:W.value}),g.setMatchedLine(null))},j=function(y){y.preventDefault();var O=H.value=="right"?3:1;if(O==y.which&&C.value&&e.value){var ne=s(y),de=ne[0],ee=ne[1],q=(de-re)/S.value,F=(ee-ue)/ie.value,x=Z+q,m=G+F;if(K!==null){var M={col:[x,x+L.value/2,x+L.value],row:[m,m+W.value/2,m+W.value]},te={row:M.row.map(function($,Q){var N=null;return Object.values(K.row).forEach(function(ae){$>=ae.min&&$<=ae.max&&(N=ae.value)}),N!==null&&(Q===0?m=N:Q===1?m=Math.floor(N-W.value/2):Q===2&&(m=Math.floor(N-W.value))),N}).filter(function($){return $!==null}),col:M.col.map(function($,Q){var N=null;return Object.values(K.col).forEach(function(ae){$>=ae.min&&$<=ae.max&&(N=ae.value)}),N!==null&&(Q===0?x=N:Q===1?x=Math.floor(N-L.value/2):Q===2&&(x=Math.floor(N-L.value))),N}).filter(function($){return $!==null})};g.setMatchedLine(te)}o("dragging",{x:oe(x),y:se(m)})}},J=function(y){u.value&&(R(!0),Z=Y.value,G=B.value,re=s(y)[0],ue=s(y)[1],i.addEvent(I,t,j),i.addEvent(I,r,X),g&&!g.disabled.value&&(K=i.getReferenceLineMap(g,z,T)))};return n.watch(C,function(y,O){!O&&y?(o("drag-start",{x:Y.value,y:B.value}),U(!0),R(!0)):(o("drag-end",{x:Y.value,y:B.value}),R(!1))}),n.onMounted(function(){var y=e.value;y&&(y.style.left=Y+"px",y.style.top=B+"px",i.addEvent(I,f,le),i.addEvent(y,f,J))}),n.onUnmounted(function(){e.value&&(i.removeEvent(I,f,le),i.removeEvent(I,r,X),i.removeEvent(I,t,j))}),{containerRef:e}}E.initDraggableContainer=v;function c(e,a,l,u,o){var g=a.setWidth,z=a.setHeight,Y=a.setLeft,B=a.setTop,L=e.width,W=e.height,C=e.left,T=e.top,R=e.aspectRatio,U=e.setResizing,P=e.setResizingHandle,k=e.setResizingMaxWidth,S=e.setResizingMaxHeight,ie=e.setResizingMinWidth,H=e.setResizingMinHeight,se=l.parentWidth,oe=l.parentHeight,Z=0,G=0,re=0,ue=0,K=0,I=0,le=1,X="",j="",J=document.documentElement,y=function(ee){ee.preventDefault();var q=s(ee),F=q[0],x=q[1],m=F-K,M=x-I,te=m,$=M;u.lockAspectRatio&&(m=Math.abs(m),M=m*le,(te<0||j==="m"&&$<0)&&(m=-m,M=-M)),X==="t"?(z(G-M),B(ue-(W.value-G))):X==="b"&&z(G+M),j==="l"?(g(Z-m),Y(re-(L.value-Z))):j==="r"&&g(Z+m),o("resizing",{x:C.value,y:T.value,w:L.value,h:W.value})},O=function(){o("resize-end",{x:C.value,y:T.value,w:L.value,h:W.value}),P(""),U(!1),k(1/0),S(1/0),ie(u.minW),H(u.minH),i.removeEvent(J,t,y),i.removeEvent(J,r,O)},ne=function(ee,q){if(u.resizable){ee.stopPropagation(),P(q),U(!0),X=q[0],j=q[1],R.value&&(["tl","tm","ml","bl"].includes(q)?(X="t",j="l"):(X="b",j="r"));var F=u.minH,x=u.minW;if(F/x>R.value?x=F/R.value:F=x*R.value,ie(x),H(F),parent){var m=X==="t"?T.value+W.value:oe.value-T.value,M=j==="l"?C.value+L.value:se.value-C.value;u.lockAspectRatio&&(m/M<R.value?M=m/R.value:m=M*R.value),S(m),k(M)}Z=L.value,G=W.value,re=C.value,ue=T.value;var te=s(ee);K=te[0],I=te[1],le=R.value,o("resize-start",{x:C.value,y:T.value,w:L.value,h:W.value}),i.addEvent(J,t,y),i.addEvent(J,r,O)}};n.onUnmounted(function(){i.removeEvent(J,r,O),i.removeEvent(J,t,y)});var de=n.computed(function(){return u.resizable?i.filterHandles(u.handles):[]});return{handlesFiltered:de,resizeHandleDown:ne}}E.initResizeHandle=c;function _(e,a){var l=a.setWidth,u=a.setHeight,o=a.setLeft,g=a.setTop;n.watch(function(){return e.w},function(z){l(z)}),n.watch(function(){return e.h},function(z){u(z)}),n.watch(function(){return e.x},function(z){o(z)}),n.watch(function(){return e.y},function(z){g(z)})}return E.watchProps=_,E}var pe;function ze(){return pe||(pe=1,function(b){var n=V&&V.__assign||function(){return n=Object.assign||function(t){for(var s,v=1,c=arguments.length;v<c;v++){s=arguments[v];for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&(t[_]=s[_])}return t},n.apply(this,arguments)},i=V&&V.__spreadArrays||function(){for(var t=0,s=0,v=arguments.length;s<v;s++)t+=arguments[s].length;for(var c=Array(t),_=0,s=0;s<v;s++)for(var e=arguments[s],a=0,l=e.length;a<l;a++,_++)c[_]=e[a];return c};b.__esModule=!0,b.ALL_HANDLES=void 0;var d=ge,p=Me(),h=he();b.ALL_HANDLES=["tl","tm","tr","ml","mr","bl","bm","br"];var A={initW:{type:Number,default:null},initH:{type:Number,default:null},w:{type:Number,default:0},h:{type:Number,default:0},x:{type:Number,default:0},y:{type:Number,default:0},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},disabledX:{type:Boolean,default:!1},disabledY:{type:Boolean,default:!1},disabledW:{type:Boolean,default:!1},disabledH:{type:Boolean,default:!1},minW:{type:Number,default:20},minH:{type:Number,default:20},active:{type:Boolean,default:!1},parent:{type:Boolean,default:!1},handles:{type:Array,default:b.ALL_HANDLES,validator:function(t){return h.filterHandles(t).length===t.length}},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},lockAspectRatio:{type:Boolean,default:!1},parentScaleX:{type:Number,default:1},parentScaleY:{type:Number,default:1},triggerKey:{type:String,default:"left"}},f=["activated","deactivated","drag-start","resize-start","dragging","resizing","drag-end","resize-end","update:w","update:h","update:x","update:y","update:active"],r=d.defineComponent({name:"Vue3DraggableResizable",props:A,emits:f,setup:function(t,s){var v=s.emit,c=p.initState(t,v),_=d.inject("identity"),e=null;_===h.IDENTITY&&(e={updatePosition:d.inject("updatePosition"),getPositionStore:d.inject("getPositionStore"),disabled:d.inject("disabled"),adsorbParent:d.inject("adsorbParent"),adsorbCols:d.inject("adsorbCols"),adsorbRows:d.inject("adsorbRows"),setMatchedLine:d.inject("setMatchedLine")});var a=d.ref(),l=p.initParent(a),u=p.initLimitSizeAndMethods(t,l,c);p.initDraggableContainer(a,c,u,d.toRef(t,"draggable"),v,e,l);var o=p.initResizeHandle(c,u,l,t,v);return p.watchProps(t,u),n(n(n(n({containerRef:a,containerProvider:e},c),l),u),o)},computed:{style:function(){return{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}},klass:function(){var t;return t={},t[this.classNameActive]=this.enable,t[this.classNameDragging]=this.dragging,t[this.classNameResizing]=this.resizing,t[this.classNameDraggable]=this.draggable,t[this.classNameResizable]=this.resizable,t}},mounted:function(){if(this.containerRef){this.containerRef.ondragstart=function(){return!1};var t=h.getElSize(this.containerRef),s=t.width,v=t.height;this.setWidth(this.initW===null?this.w||s:this.initW),this.setHeight(this.initH===null?this.h||v:this.initH),this.containerProvider&&this.containerProvider.updatePosition(this.id,{x:this.left,y:this.top,w:this.width,h:this.height})}},render:function(){var t=this;return d.h("div",{ref:"containerRef",class:["vdr-container",this.klass],style:this.style},i([this.$slots.default&&this.$slots.default()],this.handlesFiltered.map(function(s){return d.h("div",{class:["vdr-handle","vdr-handle-"+s,t.classNameHandle,t.classNameHandle+"-"+s],style:{display:t.enable?"block":"none"},onMousedown:function(v){return t.resizeHandleDown(v,s)},onTouchstart:function(v){return t.resizeHandleDown(v,s)}})})))}});b.default=r}(fe)),fe}var ve={};(function(b){var n=V&&V.__spreadArrays||function(){for(var p=0,h=0,A=arguments.length;h<A;h++)p+=arguments[h].length;for(var f=Array(p),r=0,h=0;h<A;h++)for(var t=arguments[h],s=0,v=t.length;s<v;s++,r++)f[r]=t[s];return f};b.__esModule=!0;var i=ge,d=he();b.default=i.defineComponent({name:"DraggableContainer",props:{disabled:{type:Boolean,default:!1},adsorbParent:{type:Boolean,default:!0},adsorbCols:{type:Array,default:null},adsorbRows:{type:Array,default:null},referenceLineVisible:{type:Boolean,default:!0},referenceLineColor:{type:String,default:"#f00"}},setup:function(p){var h=i.reactive({}),A=function(c,_){h[c]=_},f=function(c){var _=Object.assign({},h);return c&&delete _[c],_},r=i.reactive({matchedLine:null}),t=i.computed(function(){return r.matchedLine&&r.matchedLine.row||[]}),s=i.computed(function(){return r.matchedLine&&r.matchedLine.col||[]}),v=function(c){r.matchedLine=c};return i.provide("identity",d.IDENTITY),i.provide("updatePosition",A),i.provide("getPositionStore",f),i.provide("setMatchedLine",v),i.provide("disabled",i.toRef(p,"disabled")),i.provide("adsorbParent",i.toRef(p,"adsorbParent")),i.provide("adsorbCols",p.adsorbCols||[]),i.provide("adsorbRows",p.adsorbRows||[]),{matchedRows:t,matchedCols:s}},methods:{renderReferenceLine:function(){var p=this;return this.referenceLineVisible?n(this.matchedCols.map(function(h){return i.h("div",{style:{width:"0",height:"100%",top:"0",left:h+"px",borderLeft:"1px dashed "+p.referenceLineColor,position:"absolute"}})}),this.matchedRows.map(function(h){return i.h("div",{style:{width:"100%",height:"0",left:"0",top:h+"px",borderTop:"1px dashed "+p.referenceLineColor,position:"absolute"}})})):[]}},render:function(){return i.h("div",{style:{width:"100%",height:"100%",position:"relative"}},n([this.$slots.default&&this.$slots.default()],this.renderReferenceLine()))}})})(ve);(function(b){var n=V&&V.__createBinding||(Object.create?function(h,A,f,r){r===void 0&&(r=f),Object.defineProperty(h,r,{enumerable:!0,get:function(){return A[f]}})}:function(h,A,f,r){r===void 0&&(r=f),h[r]=A[f]});b.__esModule=!0;var i=ze(),d=ve;i.default.install=function(h){return h.component(i.default.name,i.default),h.component(d.default.name,d.default),h};var p=ve;n(b,p,"default","DraggableContainer"),b.default=i.default})(ye);const Le=He(ye);export{Le as V,ye as s};
