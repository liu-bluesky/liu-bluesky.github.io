import"./vue-Brcqt2vG.js";import{d as te,r as R,w as h,b as Y,n as J,e as ne,s as T,f as E,h as C}from"./@vue-B5Rjg0tc.js";const ae={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};var re=Object.defineProperty,q=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,U=(e,t,n)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,k=(e,t)=>{for(var n in t||(t={}))oe.call(t,n)&&U(e,n,t[n]);if(q)for(var n of q(t))ie.call(t,n)&&U(e,n,t[n]);return e};function Q(...e){return t=>e.reduceRight((n,a)=>a(n),t)}function _(e){return function t(...n){return n.length>=e.length?e.apply(this,n):(...a)=>t.apply(this,[...n,...a])}}function X(e,t){return Object.keys(t).forEach(n=>{t[n]instanceof Object&&e[n]&&Object.assign(t[n],X(e[n],t[n]))}),k(k({},e),t)}function b(e){return Object.prototype.toString.call(e).includes("Object")}function O(e){return typeof e=="function"}function le(e){return Reflect.ownKeys(e).length===0}function ue(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const ce={type:"cancelation",msg:"operation is manually canceled"};function V(e){let t=!1;const n=new Promise((a,o)=>{e.then(r=>t?o(ce):a(r)),e.catch(o)});return Object.assign(n,{cancel(){t=!0}}),n}const L={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"An unknown error occurred",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })
  `};function se(){console.warn(L.deprecation)}function de(e,t){throw new Error(e[t]||L.default)}const v=_(de)(L);function fe(e){return e||v("configIsRequired"),b(e)||v("configType"),e.urls?(se(),{paths:{vs:e.urls.monacoBase}}):e}function ve(e,t){return b(t)||v("changeType"),Object.keys(t).some(n=>!ue(e,n))&&v("changeField"),t}function ge(e){O(e)||v("selectorType")}function pe(e){O(e)||b(e)||v("handlerType"),b(e)&&Object.values(e).some(t=>!O(t))&&v("handlersType")}function he(e){e||v("initialIsRequired"),b(e)||v("initialType"),le(e)&&v("initialContent")}const w={config:fe,changes:ve,selector:ge,handler:pe,initial:he};var ye=Object.defineProperty,x=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,A=(e,t,n)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F=(e,t)=>{for(var n in t||(t={}))me.call(t,n)&&A(e,n,t[n]);if(x)for(var n of x(t))_e.call(t,n)&&A(e,n,t[n]);return e};function we(e,t){return O(t)?t(e.current):t}function be(e,t){return e.current=F(F({},e.current),t),t}function Oe(e,t,n){return O(t)?t(e.current):Object.keys(n).forEach(a=>{var o;return(o=t[a])==null?void 0:o.call(t,e.current[a])}),n}function Se(e,t={}){w.initial(e),w.handler(t);const n={current:e},a=_(Oe)(n,t),o=_(be)(n),r=_(w.changes)(e),c=_(we)(n);function g(d=p=>p){return w.selector(d),d(n.current)}function s(d){Q(a,o,r,c)(d)}return[g,s]}var H=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,Pe=(e,t)=>{var n={};for(var a in e)Me.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&H)for(var a of H(e))t.indexOf(a)<0&&je.call(e,a)&&(n[a]=e[a]);return n};const[S,I]=Se({config:ae,isInitialized:!1,resolve:null,reject:null,monaco:null}),$=new Promise((e,t)=>I({resolve:e,reject:t}));function Ee(e){const t=w.config(e),{monaco:n}=t,a=Pe(t,["monaco"]);I(o=>({config:X(o.config,a),monaco:n}))}function Ie(){const e=S(({monaco:t,isInitialized:n,resolve:a})=>({monaco:t,isInitialized:n,resolve:a}));if(!e.isInitialized){if(I({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),V($);if(window.monaco&&window.monaco.editor)return Z(window.monaco),e.resolve(window.monaco),V($);Q(Ce,$e)(Te)}return V($)}function Ce(e){return document.body.appendChild(e)}function Ve(e){const t=document.createElement("script");return e&&(t.src=e),t}function $e(e){const t=S(({config:a,reject:o})=>({config:a,reject:o})),n=Ve(`${t.config.paths.vs}/loader.js`);return n.onload=()=>e(),n.onerror=t.reject,n}function Te(){const e=S(({config:n,resolve:a,reject:o})=>({config:n,resolve:a,reject:o})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],n=>{Z(n),e.resolve(n)},n=>{e.reject(n)})}function Z(e){S().monaco||I({monaco:e})}function Re(){return S(({monaco:e})=>e)}var B={config:Ee,init:Ie,getMonacoInstance:Re};function Le(){}function D(e){return/^\d+$/.test(e)?`${e}px`:e}function z(e,t,n,a){return Ne(e,a)||qe(e,t,n,a)}function Ne(e,t){return e.editor.getModel(ee(e,t))}function qe(e,t,n,a){return e.editor.createModel(t,n,a?ee(e,a):void 0)}function ee(e,t){return e.Uri.parse(t)}function W(e){return typeof e=="function"?e():e}function Ue(e,t){const n=E(()=>({display:"flex",position:"relative",textAlign:"initial",width:D(e.width),height:D(e.height)})),a=E(()=>{const r={width:"100%"};return t.value||(r.display="none"),r}),o=E(()=>({display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}));return{getWrapperStyle:n,getContainerStyle:a,getLoadingStyle:o}}function ke(){const e=T(B.getMonacoInstance()),t=R(!1);let n;return Y(async()=>{try{if(e.value)return;n=B.init(),e.value=await n}catch(o){(o==null?void 0:o.type)!=="cancelation"?(t.value=!0,console.error("Monaco initialization error:",o)):t.value=!1}}),{monacoRef:e,unload:()=>n==null?void 0:n.cancel(),isLoadFailed:t}}function xe(e,t,n){const{monacoRef:a,unload:o,isLoadFailed:r}=ke(),c=T(null),g=T(null),s=E(()=>!!a.value&&!!c.value),{getWrapperStyle:d,getContainerStyle:p,getLoadingStyle:y}=Ue({width:e.width,height:e.height},s);function M(l){return function(...u){s.value&&l.apply(this,u)}}return h(()=>e.theme,M(l=>{var u;return(u=a.value)==null?void 0:u.editor.setTheme(l)})),h(()=>e.options,l=>{var u;return(u=c.value)==null?void 0:u.updateOptions(l)},{deep:!0}),{render:()=>{var l,u,f;return C("section",{style:d.value},[!s.value&&C("div",{style:y.value},r.value?t.slots.failure?W((l=t.slots)==null?void 0:l.failure):"load failed":(u=t.slots)!=null&&u.loading?W((f=t.slots)==null?void 0:f.loading):"loading..."),C("div",{ref:g,key:n,style:p.value,class:e.className})])},monacoRef:a,containerRef:g,editorRef:c,unload:o,whenMonacoIsReady:M}}function Ae(e,t,n){const a=R(Le),o=h(()=>[t,n],()=>{if(t.value&&n.value){J(()=>o());const r=t.value.editor.onDidChangeMarkers(c=>{var g,s;const d=(s=(g=n.value)==null?void 0:g.getModel())==null?void 0:s.uri;if(d&&c.find(y=>y.path===d.path)){const y=t.value.editor.getModelMarkers({resource:d});e("validate",y)}});a.value=()=>r==null?void 0:r.dispose()}});return{disposeValidator:a}}const Fe={defaultValue:{type:String},defaultLanguage:{type:String},defaultPath:{type:String},value:{type:String,value:""},language:{type:String,default:"javascript"},path:{type:String,default:""},theme:{type:String,default:"light"},line:{type:Number},options:{type:Object,default:()=>({})},overrideServices:{type:Object},saveViewState:{type:Boolean,default:!0},keepCurrentModel:{type:Boolean,default:!1},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:{type:String}};var He=Object.defineProperty,G=Object.getOwnPropertySymbols,Be=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,K=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ze=(e,t)=>{for(var n in t||(t={}))Be.call(t,n)&&K(e,n,t[n]);if(G)for(var n of G(t))De.call(t,n)&&K(e,n,t[n]);return e};const P=new Map;var Ke=te({name:"MonacoEditor",props:Fe,emits:["update:value","beforeMount","mount","change","validate"],slots:Object,setup(e,t){const{emit:n}=t,{render:a,containerRef:o,editorRef:r,monacoRef:c,unload:g,whenMonacoIsReady:s}=xe(e,t,"vue-monaco-editor"),{disposeValidator:d}=Ae(n,c,r),p=R(!1);h(()=>e.path,s((i,l)=>{var u,f,j;const m=z(c.value,e.defaultValue||e.value||"",e.defaultLanguage||e.language||"",e.path||e.defaultPath||"");m!==((u=r.value)==null?void 0:u.getModel())&&(e.saveViewState&&P.set(l,r.value.saveViewState()),(f=r.value)==null||f.setModel(m),e.saveViewState&&((j=r.value)==null||j.restoreViewState(P.get(i))))})),h(()=>e.value,s(i=>{!r.value||i===void 0||(r.value.getOption(c.value.editor.EditorOption.readOnly)?r.value.setValue(i):i!==r.value.getValue()&&(p.value=!0,r.value.executeEdits("",[{range:r.value.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),r.value.pushUndoStop(),p.value=!1))})),h(()=>e.language,s(i=>{var l,u;const f=(l=r.value)==null?void 0:l.getModel();f&&i&&((u=c.value)==null||u.editor.setModelLanguage(f,i))})),h(()=>e.line,s(i=>{var l;i!==void 0&&((l=r.value)==null||l.revealLine(i))}));const y=()=>{var i,l,u;if(!o.value||!c.value||r.value)return;n("beforeMount",c.value);const f=e.path||e.defaultPath,j=z(c.value,e.value||e.defaultValue||"",e.language||e.defaultLanguage||"",f||"");if(r.value=(i=c.value)==null?void 0:i.editor.create(o.value,ze({model:j,theme:e.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0},e.options),e.overrideServices),(l=r.value)==null||l.onDidChangeModelContent(m=>{if(!p.value){const N=r.value.getValue();n("update:value",N),n("change",N,m)}}),e.saveViewState){const m=P.get(f);m&&r.value.restoreViewState(m)}e.line!==void 0&&((u=r.value)==null||u.revealLine(e.line)),n("mount",r.value,c.value)};Y(()=>{const i=h(()=>c.value,l=>{o.value&&l&&(J(()=>i()),y())},{immediate:!0})}),ne(()=>{var i;(i=d.value)==null||i.call(d),r.value?M():g()});function M(){var i,l;e.keepCurrentModel&&(e.saveViewState?P.set(e.path,r.value.saveViewState()):(i=r.value.getModel())==null||i.dispose()),(l=r.value)==null||l.dispose()}return a}});export{Ke as M};
