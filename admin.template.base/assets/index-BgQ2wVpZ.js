import"./vue-BOAnm8BJ.js";import{u as z,a as G}from"./vue-router-DgaeXL21.js";import H from"./deptTree-BoA-oMOm.js";import{f as K,r as Q}from"./index-CxwxT6J_.js";import{_ as J}from"./index-D8uVrJWJ.js";import{_ as W}from"./AllRight.vue_vue_type_script_setup_true_lang-CiGeGNpT.js";import{_ as X}from"./addOrEdit.vue_vue_type_script_setup_true_lang-D8HqoM4M.js";import{e as Y,l as Z,f as ee,d as te,r as oe}from"./user-BQx4WHv-.js";import{b as se}from"./config-C-MPfl_P.js";import{c as b,a as c}from"./element-plus-DCyP7bP4.js";import{d as re,A as v,b as x,r as k,s as y,j as o,i as r,q as a,o as ae,c as ne,a as T,k as s,u as C,n as le}from"./@vue-C7kBaxf_.js";import"./axios-CdcsOsvR.js";import"./vuex-fAqGcTDK.js";import"./js-cookie-Cz0CWeBA.js";import"./path-browserify-D3uKt2uU.js";import"./vue-i18n-CbYyLErm.js";import"./@intlify-D_0T6EgR.js";import"./@vueuse-C3s7uLKR.js";import"./@element-plus-CaqvGD6o.js";/* empty css                    */import"./dayjs-CuLmuTop.js";import"./element-easy-print-4c_yq0aR.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-DIkZKdRf.js";import"./element-easy-form-CEkbENOi.js";import"./vuedraggable-DF9qvgpV.js";import"./pinia-BsMBDaf_.js";import"./vue-demi-Zo4Nq4nd.js";import"./@vue-monaco-CNmGcFBZ.js";import"./uuid-CQkTLCs1.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";import"./drawer-D6M5jU95.js";import"./detail.vue_vue_type_script_setup_true_name_userDetail_lang-B_vgd5o_.js";import"./detail-Bex21FUx.js";const ie={class:"commonBoxmp"},ue={class:"aic h100"},de={class:"jcb aic w100"},et=re({__name:"index",setup(me){z(),G();const{parseTime:pe,addDateRange:ce,getDict:I}=K();let h=v({sys_job_status:[]});x(async()=>{h.sys_job_status=await I("sys_job_status")}),k();const f=y(!1),i=y(""),u=y(!1),V=e=>{i.value=e.userId,f.value=!0},g=v({initPassword:"",height:0,deptOptions:[],form:{},rules:{userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:2,max:20,message:"用户名称长度必须介于 2 和 20 之间",trigger:"blur"}],nickName:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]},dateRange:[],postOptions:[],roleOptions:[],tableData:[],userVisible:!1,columnData:[{label:"用户名称",prop:"userName",render:({row:e})=>o(r("el-link"),{type:"primary",onClick:()=>V(e)},{default:()=>[e.userName]}),visible:!0,filter:{flterType:"input"}},{label:"用户昵称",prop:"nickName",visible:!0,filter:{flterType:"input"}},{label:"部门",prop:"dept.deptName",visible:!0},{label:"手机号",prop:"phonenumber",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>o(J,{values:e.status,dataType:"primary",options:h.sys_job_status,onClick:()=>P(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],operation:{label:"操作",prop:"操作",width:"180",fixed:"right",visible:!0,render:({row:e})=>o("div",null,[o(r("el-button"),{type:"primary",size:"small"},{default:()=>[a("编辑")]}),o(r("el-button"),{type:"danger",size:"small"},{default:()=>[a("删除")]})])},loading:!1}),d=v({pageNum:1,pageSize:10,deptId:void 0}),N=()=>{d.pageNum=1;const e=C(d);m.value.getList(e)},U=e=>{d.deptId=e.id,N()},D=()=>{i.value="",u.value=!0},m=k(),P=e=>{let t=e.status==="0"?"启用":"停用";b.confirm('确认要"'+t+'""'+e.userName+'"用户吗？').then(function(){const n={userId:e.userId,status:e.status};return Y(n)}).then(()=>{c.success(t+"成功"),m.value.getList()}).catch(function(){})},B=e=>{const t=e.userId;b.confirm('是否确认删除用户编号为"'+t+'"的数据项？').then(function(){return ee(t)}).then(()=>{p(),c.success("删除成功")}).catch(function(){})},R=e=>{i.value=String(e.userId),le(()=>{u.value=!0})},j=e=>{b.prompt("请输入新的密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{oe({userId:e.userId,password:e.value}).then(n=>{c({type:"success",message:"更新成功"}),p()})}).catch(()=>{c({type:"info",message:"Input canceled"})})},$=(e,t)=>{switch(e){case"updatePwd":j(t);break;case"updaterole":q(t);break}},q=e=>{const t=e.userId;Q("/system/user-auth/role/"+t)},p=()=>{m.value.getList()},S=()=>{te().then(e=>{g.deptOptions=e.data})};return x(()=>{se("sys.user.initPassword").then(e=>{g.initPassword=e.msg}),p(),S()}),(e,t)=>{const n=r("el-button"),A=r("arrow-down"),E=r("el-icon"),w=r("el-dropdown-item"),F=r("el-dropdown-menu"),L=r("el-dropdown"),M=r("el-table-column"),O=r("TableV2");return ae(),ne("div",ie,[T("div",ue,[o(H,{style:{"margin-right":"10px"},onUpdateDept:U}),o(O,{apiFunction:C(Z),class:"flex1",isInit:!1,filter:{...d},ref_key:"tableV2Ref",ref:m,columns:g.columnData},{tableHeader:s(()=>[T("div",de,[o(n,{type:"primary",onClick:D},{default:s(()=>t[2]||(t[2]=[a("添加用户")])),_:1})])]),operation:s(()=>[o(M,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:s(l=>[o(n,{type:"text",onClick:_=>R(l.row)},{default:s(()=>t[3]||(t[3]=[a("修改")])),_:2},1032,["onClick"]),o(n,{type:"text",onClick:_=>B(l.row)},{default:s(()=>t[4]||(t[4]=[a("删除")])),_:2},1032,["onClick"]),o(L,{onCommand:_=>$(_,l.row)},{dropdown:s(()=>[o(F,null,{default:s(()=>[o(w,{command:"updatePwd"},{default:s(()=>t[6]||(t[6]=[a("更换密码")])),_:1}),o(w,{command:"updaterole"},{default:s(()=>t[7]||(t[7]=[a("分配角色")])),_:1})]),_:1})]),default:s(()=>[o(n,{class:"ml10",type:"text"},{default:s(()=>[t[5]||(t[5]=a(" 更多 ")),o(E,{class:"el-icon--right"},{default:s(()=>[o(A)]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["apiFunction","filter","columns"])]),o(W,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value=l),id:i.value},null,8,["modelValue","id"]),o(X,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=l=>u.value=l),id:i.value,onUpdate:p},null,8,["modelValue","id"])])}}});export{et as default};
