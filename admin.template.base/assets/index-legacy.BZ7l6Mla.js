System.register(["./vue-legacy.BmYqjNm6.js","./vue-router-legacy.CS8XlyrO.js","./index-legacy.ByyWJ1r4.js","./index-legacy.foMZjjNw.js","./role-legacy.Bg4eVF-Z.js","./addOrEdit.vue_vue_type_script_setup_true_lang-legacy.ZsfeySsi.js","./menu-legacy.C3MZuA7u.js","./element-plus-legacy.CkGmQsvp.js","./@vue-legacy.Wt3blPL2.js","./axios-legacy.DBjxdIo9.js","./pinia-legacy.DuSvsY-k.js","./vue-demi-legacy.IwaVch8H.js","./js-cookie-legacy.DG9X5X6R.js","./@vueuse-legacy.DSS55YJ-.js","./vue-i18n-legacy.CQRl9MO2.js","./@intlify-legacy.B2b6NwAY.js","./animate.css-legacy.BfzBEcwY.js","./dayjs-legacy.DqxV5GdU.js","./element-easy-print-legacy.Bhsouh8x.js","./mockjs-legacy.DI-hmJr1.js","./vue3-draggable-resizable-yn-legacy.BHLFICD8.js","./element-easy-form-legacy.D6XKxA-M.js","./lodash-legacy.BuA_2Y3z.js","./vuedraggable-legacy.lX_CBnec.js","./@vue-monaco-legacy.BMCOK2-c.js","./uuid-legacy.2vyezZly.js","./@element-plus-legacy.DgWkyxe6.js","./lodash-es-legacy.C0SrPjaY.js","./@popperjs-legacy.Dycg7rOj.js","./@ctrl-legacy.BxnR6uzU.js","./async-validator-legacy.DmN8ALBH.js","./memoize-one-legacy.BFFEFRop.js","./normalize-wheel-es-legacy.BGuSd53u.js","./@floating-ui-legacy.-y5top_l.js"],(function(e,l){"use strict";var a,t,o,u,d,n,r,s,c,m,i,p,f,y,g,h,b,_,V,v,j,k,C,x,S,w,U,N,D,I,K,O,A,E,F,R,q;return{setters:[null,e=>{a=e.u,t=e.b},e=>{o=e.p,u=e.f,d=e.r},e=>{n=e._},e=>{r=e.f,s=e.l,c=e.h,m=e.d,i=e.e,p=e.i,f=e.g,y=e.j},e=>{g=e._},e=>{h=e.t},e=>{b=e.c,_=e.a},e=>{V=e.d,v=e.s,j=e.A,k=e.b,C=e.j,x=e.r,S=e.i,w=e.o,U=e.c,N=e.k,D=e.a,I=e.q,K=e.u,O=e.F,A=e.l,E=e.m,F=e.X,R=e.Y,q=e.n},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l={class:"commonBoxmp"},z={class:"jcb aic w100"},T={class:"aic"},H={class:"dialog-footer"},P={class:"dialog-footer"};e("default",V({__name:"index",setup(e){a(),t();const V=v(""),{parseTime:M,addDateRange:B,getDict:G}=u(),L=v(!1);let Q=j({sys_job_status:[]});k((async()=>{Q.sys_job_status=await G("sys_job_status")}));const X=j({openDataScope:!1,defaultProps:{children:"children",label:"label"},menuOptions:[],deptOptions:[],dataScopeOptions:[{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}],deptExpand:!1,deptNodeAll:!1,menuExpand:!1,menuNodeAll:!1,title:"",form:{},userVisible:!1,rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"角色编号",prop:"roleId",visible:!0},{label:"角色名称",prop:"roleName",visible:!0},{label:"权限字符",prop:"roleKey",visible:!0},{label:"显示顺序",prop:"roleSort",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>C(n,{values:e.status,dataType:"primary",options:Q.sys_job_status,onClick:()=>de(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],loading:!1}),Y=e=>{null!=X.form.roleId&&(X.form.deptIds=(()=>{let e=ae.value.getCheckedKeys(),l=ae.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),c(X.form).then((e=>{X.openDataScope=!1,$()})))},J=async e=>{e&&(await e.validate(),X.form.menuIds=(()=>{let e=le.value.getCheckedKeys(),l=le.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),null!=X.form.roleId?m(X.form).then((e=>{_.success("修改成功"),X.userVisible=!1,$()})):i(X.form).then((e=>{_.success("新增成功"),X.userVisible=!1,$()})))},W=()=>{V.value="",oe(),L.value=!0},Z=x(),$=()=>{Z.value.getList()},ee=x(),le=x(),ae=x(),te=(e,l)=>{switch(e){case"handleDataScope":(e=>{X.form={};const l=ue(e.roleId);f(e.roleId).then((e=>{X.form=e.data,X.openDataScope=!0,q((()=>{l.then((e=>{ae.value.setCheckedKeys(e.checkedKeys)}))})),X.title="分配数据权限"}))})(l);break;case"handleAuthUser":(e=>{const l=e.roleId;d("/system/role-auth/user/"+l)})(l)}},oe=()=>{h().then((e=>{X.menuOptions=e.data}))},ue=e=>y(e).then((e=>(X.deptOptions=e.depts,e))),de=e=>{let l="0"===e.status?"启用":"停用";b.confirm('确认要"'+l+'""'+e.roleName+'"角色吗？').then((function(){return r(e.roleId,e.status)})).then((()=>{_.success(l+"成功")})).catch((function(){e.status="0"===e.status?"1":"0"}))},ne=(e,l)=>{if("menu"==l){let l=X.menuOptions;for(let a=0;a<l.length;a++)le.value.store.nodesMap[l[a].id].expanded=e}else if("dept"==l){let l=X.deptOptions;for(let a=0;a<l.length;a++)ae.value.store.nodesMap[l[a].id].expanded=e}},re=(e,l)=>{"menu"==l?le.value.setCheckedNodes(e?X.menuOptions:[]):"dept"==l&&ae.value.setCheckedNodes(e?X.deptOptions:[])},se=(e,l)=>{"menu"==l?X.form.menuCheckStrictly=!!e:"dept"==l&&(X.form.deptCheckStrictly=!!e)};return k((()=>{$()})),(e,a)=>{const t=S("el-button"),u=S("arrow-down"),d=S("el-icon"),n=S("el-dropdown-item"),r=S("el-dropdown-menu"),c=S("el-dropdown"),m=S("el-table-column"),i=S("TableV2"),f=S("el-input"),y=S("el-form-item"),h=S("el-col"),v=S("QuestionFilled"),j=S("el-tooltip"),k=S("el-row"),x=S("el-input-number"),q=S("el-checkbox"),M=S("el-tree"),B=S("el-form"),G=S("el-dialog"),Q=S("el-option"),ae=S("el-select");return w(),U("div",l,[C(i,{class:"flex1",apiFunction:K(s),isInit:!1,filter:{},ref_key:"tableV2Ref",ref:Z,columns:X.columnData},{tableHeader:N((()=>[D("div",z,[C(t,{type:"primary",onClick:W},{default:N((()=>a[26]||(a[26]=[I("添加角色")]))),_:1})])])),operation:N((()=>[C(m,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:N((e=>[C(t,{type:"text",onClick:l=>{return a=e.row,V.value=a.roleId,void(L.value=!0);var a}},{default:N((()=>a[27]||(a[27]=[I("修改")]))),_:2},1032,["onClick"]),C(t,{type:"text",onClick:l=>(e=>{const l=e.roleId;b.confirm('是否确认删除角色编号为"'+l+'"的数据项？').then((function(){return p(l)})).then((()=>{_.success("删除成功"),$()})).catch((function(){}))})(e.row)},{default:N((()=>a[28]||(a[28]=[I("删除")]))),_:2},1032,["onClick"]),C(c,{onCommand:l=>te(l,e.row)},{dropdown:N((()=>[C(r,null,{default:N((()=>[C(n,{command:"handleDataScope"},{default:N((()=>a[30]||(a[30]=[I("数据权限")]))),_:1}),C(n,{command:"handleAuthUser"},{default:N((()=>a[31]||(a[31]=[I("分配用户")]))),_:1})])),_:1})])),default:N((()=>[C(t,{class:"ml10",type:"text"},{default:N((()=>[a[29]||(a[29]=I(" 更多 ")),C(d,{class:"el-icon--right"},{default:N((()=>[C(u)])),_:1})])),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["apiFunction","columns"]),C(G,{modelValue:X.userVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>X.userVisible=e),title:X.title,width:"50%","destroy-on-close":"",center:""},{footer:N((()=>[D("span",H,[C(t,{onClick:a[11]||(a[11]=e=>X.userVisible=!1)},{default:N((()=>a[36]||(a[36]=[I("取消")]))),_:1}),C(t,{type:"primary",onClick:a[12]||(a[12]=e=>J(ee.value))},{default:N((()=>a[37]||(a[37]=[I(" 确定 ")]))),_:1})])])),default:N((()=>[C(B,{ref_key:"ruleFormRef",ref:ee,model:X.form,rules:X.rules,"label-width":"120px",class:"demo-ruleForm"},{default:N((()=>[C(k,{gutter:20},{default:N((()=>[C(h,{span:12},{default:N((()=>[C(y,{label:"角色名称",prop:"roleName"},{default:N((()=>[C(f,{modelValue:X.form.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>X.form.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1})])),_:1}),C(h,{span:12},{default:N((()=>[C(y,{prop:"roleKey"},{label:N((()=>[D("div",T,[C(j,{content:"控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)",placement:"top"},{default:N((()=>[C(d,null,{default:N((()=>[C(v)])),_:1})])),_:1}),a[32]||(a[32]=I(" 权限字符 "))])])),default:N((()=>[C(f,{modelValue:X.form.roleKey,"onUpdate:modelValue":a[1]||(a[1]=e=>X.form.roleKey=e),placeholder:"请输入权限字符"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),C(k,{gutter:20},{default:N((()=>[C(h,{span:12},{default:N((()=>[C(y,{label:"角色顺序",prop:"roleSort"},{default:N((()=>[C(x,{modelValue:X.form.roleSort,"onUpdate:modelValue":a[2]||(a[2]=e=>X.form.roleSort=e),"controls-position":"right",min:0},null,8,["modelValue"])])),_:1})])),_:1}),C(h,{span:12},{default:N((()=>[C(y,{label:"状态"},{default:N((()=>[C(o,{class:"w100",dataType:"radio",dictCode:"sys_normal_disable",modelValue:X.form.status,"onUpdate:modelValue":a[3]||(a[3]=e=>X.form.status=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),C(k,{gutter:20},{default:N((()=>[C(h,{span:24},{default:N((()=>[C(y,{label:"菜单权限",prop:"roleSort"},{default:N((()=>[D("div",null,[D("div",null,[C(q,{modelValue:X.menuExpand,"onUpdate:modelValue":a[4]||(a[4]=e=>X.menuExpand=e),onChange:a[5]||(a[5]=e=>ne(e,"menu"))},{default:N((()=>a[33]||(a[33]=[I("展开/折叠")]))),_:1},8,["modelValue"]),C(q,{modelValue:X.menuNodeAll,"onUpdate:modelValue":a[6]||(a[6]=e=>X.menuNodeAll=e),onChange:a[7]||(a[7]=e=>re(e,"menu"))},{default:N((()=>a[34]||(a[34]=[I("全选/全不选")]))),_:1},8,["modelValue"]),C(q,{modelValue:X.form.menuCheckStrictly,"onUpdate:modelValue":a[8]||(a[8]=e=>X.form.menuCheckStrictly=e),onChange:a[9]||(a[9]=e=>se(e,"menu"))},{default:N((()=>a[35]||(a[35]=[I("父子联动")]))),_:1},8,["modelValue"])]),C(M,{class:"tree-border",data:X.menuOptions,"show-checkbox":"",ref_key:"treeRef",ref:le,"node-key":"id","check-strictly":!X.form.menuCheckStrictly,"empty-text":"加载中，请稍候",props:X.defaultProps},null,8,["data","check-strictly","props"])])])),_:1})])),_:1})])),_:1}),C(k,null,{default:N((()=>[C(h,{span:24},{default:N((()=>[C(y,{label:"备注"},{default:N((()=>[C(f,{modelValue:X.form.remark,"onUpdate:modelValue":a[10]||(a[10]=e=>X.form.remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),C(G,{title:X.title,modelValue:X.openDataScope,"onUpdate:modelValue":a[24]||(a[24]=e=>X.openDataScope=e),width:"500px","append-to-body":""},{footer:N((()=>[D("div",P,[C(t,{type:"primary",onClick:Y},{default:N((()=>a[41]||(a[41]=[I("确 定")]))),_:1}),C(t,{onClick:a[23]||(a[23]=e=>X.openDataScope=!1)},{default:N((()=>a[42]||(a[42]=[I("取 消")]))),_:1})])])),default:N((()=>[C(B,{model:X.form,"label-width":"80px"},{default:N((()=>[C(y,{label:"角色名称"},{default:N((()=>[C(f,{modelValue:X.form.roleName,"onUpdate:modelValue":a[14]||(a[14]=e=>X.form.roleName=e),disabled:!0},null,8,["modelValue"])])),_:1}),C(y,{label:"权限字符"},{default:N((()=>[C(f,{modelValue:X.form.roleKey,"onUpdate:modelValue":a[15]||(a[15]=e=>X.form.roleKey=e),disabled:!0},null,8,["modelValue"])])),_:1}),C(y,{label:"权限范围"},{default:N((()=>[C(ae,{modelValue:X.form.dataScope,"onUpdate:modelValue":a[16]||(a[16]=e=>X.form.dataScope=e),onChange:e.dataScopeSelectChange},{default:N((()=>[(w(!0),U(O,null,A(X.dataScopeOptions,(e=>(w(),E(Q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),F(C(y,{label:"数据权限"},{default:N((()=>[C(q,{modelValue:X.deptExpand,"onUpdate:modelValue":a[17]||(a[17]=e=>X.deptExpand=e),onChange:a[18]||(a[18]=e=>ne(e,"dept"))},{default:N((()=>a[38]||(a[38]=[I("展开/折叠")]))),_:1},8,["modelValue"]),C(q,{modelValue:X.deptNodeAll,"onUpdate:modelValue":a[19]||(a[19]=e=>X.deptNodeAll=e),onChange:a[20]||(a[20]=e=>re(e,"dept"))},{default:N((()=>a[39]||(a[39]=[I("全选/全不选")]))),_:1},8,["modelValue"]),C(q,{modelValue:X.form.deptCheckStrictly,"onUpdate:modelValue":a[21]||(a[21]=e=>X.form.deptCheckStrictly=e),onChange:a[22]||(a[22]=e=>se(e,"dept"))},{default:N((()=>a[40]||(a[40]=[I("父子联动")]))),_:1},8,["modelValue"]),C(M,{class:"tree-border",data:X.deptOptions,"show-checkbox":"","default-expand-all":"",ref:"dept","node-key":"id","check-strictly":!X.form.deptCheckStrictly,"empty-text":"加载中，请稍候",props:X.defaultProps},null,8,["data","check-strictly","props"])])),_:1},512),[[R,2==X.form.dataScope]])])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),C(g,{modelValue:L.value,"onUpdate:modelValue":a[25]||(a[25]=e=>L.value=e),id:V.value,onUpdate:$},null,8,["modelValue","id"])])}}}))}}}));
