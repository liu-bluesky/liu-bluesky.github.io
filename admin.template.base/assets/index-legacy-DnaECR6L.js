System.register(["./vue-legacy-BwqaE-UV.js","./vue-router-legacy-D0FjC2WZ.js","./index-legacy-DkHySrN9.js","./index-legacy-QJMV1jcd.js","./role-legacy-I_0by_47.js","./addOrEdit-legacy-Cb5QYI10.js","./menu-legacy-DRaHebqR.js","./element-plus-legacy-wKlBsICL.js","./@vue-legacy-DnKxfRmB.js","./axios-legacy-DOQcXz3s.js","./pinia-legacy-CPPRg8p1.js","./vue-demi-legacy-DUElpuNi.js","./@vueuse-legacy-B8BAriPD.js","./js-cookie-legacy-C5MzxRlA.js","./vue-i18n-legacy-I02oa_8H.js","./@intlify-legacy-DKMS_M3y.js","./animate.css-legacy-z9SqsCt_.js","./dayjs-legacy-BEK7-do9.js","./element-easy-print-legacy-P4zBGZwT.js","./mockjs-legacy-B6RXmGMp.js","./lodash-legacy-BjC4_Cl0.js","./vue3-draggable-resizable-yn-legacy-DjejEIa5.js","./element-easy-form-legacy-DUWnY3xV.js","./vuedraggable-legacy-COMv7T1_.js","./@vue-monaco-legacy-CjDR2hhE.js","./uuid-legacy-BdquiBiX.js","./@element-plus-legacy-Cp3RqB0e.js","./lodash-es-legacy-C-A1-n4T.js","./@popperjs-legacy-C1grkGOr.js","./@ctrl-legacy-9okVt3ht.js","./async-validator-legacy-CHN_Z1xY.js","./memoize-one-legacy-BdKv67M6.js","./normalize-wheel-es-legacy-k5qzjKXA.js","./@floating-ui-legacy-CYdxb3Dm.js"],function(e,l){"use strict";var a,t,o,d,u,n,r,s,i,c,m,p,f,y,g,h,b,_,v,V,k,j,C,x,S,w,U,N,D,O,I,K,A,E,R,F,q,T,z;return{setters:[null,e=>{a=e.u,t=e.b},e=>{o=e.g,d=e.i,u=e.r,n=e.a},e=>{r=e.D},e=>{s=e.f,i=e.l,c=e.h,m=e.d,p=e.e,f=e.i,y=e.g,g=e.j},e=>{h=e.default},e=>{b=e.t},e=>{_=e.c,v=e.a},e=>{V=e.d,k=e.s,j=e.B,C=e.b,x=e.k,S=e.r,w=e.j,U=e.o,N=e.c,D=e.l,O=e.a,I=e.v,K=e.u,A=e.y,E=e.F,R=e.m,F=e.q,q=e.Q,T=e.R,z=e.n},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l={class:"commonBoxmp"},P={class:"jcb aic w100"},H={class:"aic"},M={class:"aic"},B={class:"dialog-footer"},Q={class:"dialog-footer"},G=V({__name:"index",setup(e){a(),t();const n=k(""),{parseTime:V,addDateRange:G,getDict:J}=d(),L=k(!1);let W=j({sys_job_status:[]});C(async()=>{W.sys_job_status=await J("sys_job_status")});const X=j({openDataScope:!1,defaultProps:{children:"children",label:"label"},menuOptions:[],deptOptions:[],dataScopeOptions:[{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}],deptExpand:!1,deptNodeAll:!1,menuExpand:!1,menuNodeAll:!1,title:"",form:{},userVisible:!1,rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"角色编号",prop:"roleId",visible:!0},{label:"角色名称",prop:"roleName",visible:!0},{label:"权限字符",prop:"roleKey",visible:!0},{label:"显示顺序",prop:"roleSort",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>x(r,{values:e.status,dataType:"primary",options:W.sys_job_status,onClick:()=>re(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],loading:!1}),Y=e=>{null!=X.form.roleId&&(X.form.deptIds=(()=>{let e=oe.value.getCheckedKeys(),l=oe.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),c(X.form).then(e=>{X.openDataScope=!1,le()}))},Z=async e=>{e&&(await e.validate(),X.form.menuIds=(()=>{let e=te.value.getCheckedKeys(),l=te.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),null!=X.form.roleId?m(X.form).then(e=>{v.success("修改成功"),X.userVisible=!1,le()}):p(X.form).then(e=>{v.success("新增成功"),X.userVisible=!1,le()}))},$=()=>{n.value="",ue(),L.value=!0},ee=S(),le=()=>{ee.value.getList()},ae=S(),te=S(),oe=S(),de=(e,l)=>{switch(e){case"handleDataScope":(e=>{X.form={};const l=ne(e.roleId);y(e.roleId).then(e=>{X.form=e.data,X.openDataScope=!0,z(()=>{l.then(e=>{oe.value.setCheckedKeys(e.checkedKeys)})}),X.title="分配数据权限"})})(l);break;case"handleAuthUser":(e=>{const l=e.roleId;u("/system/role-auth/user/"+l)})(l)}},ue=()=>{b().then(e=>{X.menuOptions=e.data})},ne=e=>g(e).then(e=>(X.deptOptions=e.depts,e)),re=e=>{let l="0"===e.status?"启用":"停用";_.confirm('确认要"'+l+'""'+e.roleName+'"角色吗？').then(function(){return s(e.roleId,e.status)}).then(()=>{v.success(l+"成功")}).catch(function(){e.status="0"===e.status?"1":"0"})},se=(e,l)=>{if("menu"==l){let l=X.menuOptions;for(let a=0;a<l.length;a++)te.value.store.nodesMap[l[a].id].expanded=e}else if("dept"==l){let l=X.deptOptions;for(let a=0;a<l.length;a++)oe.value.store.nodesMap[l[a].id].expanded=e}},ie=(e,l)=>{"menu"==l?te.value.setCheckedNodes(e?X.menuOptions:[]):"dept"==l&&oe.value.setCheckedNodes(e?X.deptOptions:[])},ce=(e,l)=>{"menu"==l?X.form.menuCheckStrictly=!!e:"dept"==l&&(X.form.deptCheckStrictly=!!e)};return C(()=>{le()}),(e,a)=>{const t=w("el-button"),d=w("el-link"),u=w("arrow-down"),r=w("el-icon"),s=w("el-dropdown-item"),c=w("el-dropdown-menu"),m=w("el-dropdown"),p=w("el-table-column"),y=w("TableV2"),g=w("el-input"),b=w("el-form-item"),V=w("el-col"),k=w("QuestionFilled"),j=w("el-tooltip"),C=w("el-row"),S=w("el-input-number"),z=w("el-checkbox"),G=w("el-tree"),J=w("el-form"),W=w("el-dialog"),oe=w("el-option"),ue=w("el-select");return U(),N("div",l,[x(y,{class:"flex1",apiFunction:K(i),isInit:!1,filter:{},ref_key:"tableV2Ref",ref:ee,columns:X.columnData},{tableHeader:D(()=>[O("div",P,[x(t,{type:"primary",onClick:$},{default:D(()=>a[26]||(a[26]=[I("添加角色")])),_:1})])]),operation:D(()=>[x(p,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:D(e=>[O("div",H,[x(d,{type:"primary",onClick:l=>{return a=e.row,n.value=a.roleId,void(L.value=!0);var a}},{default:D(()=>a[27]||(a[27]=[I("修改")])),_:2},1032,["onClick"]),x(d,{type:"primary",class:"mx5",onClick:l=>(e=>{const l=e.roleId;_.confirm('是否确认删除角色编号为"'+l+'"的数据项？').then(function(){return f(l)}).then(()=>{v.success("删除成功"),le()}).catch(function(){})})(e.row)},{default:D(()=>a[28]||(a[28]=[I("删除")])),_:2},1032,["onClick"]),x(m,{onCommand:l=>de(l,e.row)},{dropdown:D(()=>[x(c,null,{default:D(()=>[x(s,{command:"handleDataScope"},{default:D(()=>a[30]||(a[30]=[I("数据权限")])),_:1}),x(s,{command:"handleAuthUser"},{default:D(()=>a[31]||(a[31]=[I("分配用户")])),_:1})]),_:1})]),default:D(()=>[x(d,{class:"ml10",type:"primary"},{default:D(()=>[a[29]||(a[29]=I(" 更多 ")),x(r,{class:"el-icon--right"},{default:D(()=>[x(u)]),_:1})]),_:1})]),_:2},1032,["onCommand"])])]),_:1})]),_:1},8,["apiFunction","columns"]),x(W,{modelValue:X.userVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>X.userVisible=e),title:X.title,width:"50%","destroy-on-close":"",center:""},{footer:D(()=>[O("span",B,[x(t,{onClick:a[11]||(a[11]=e=>X.userVisible=!1)},{default:D(()=>a[36]||(a[36]=[I("取消")])),_:1}),x(t,{type:"primary",onClick:a[12]||(a[12]=e=>Z(ae.value))},{default:D(()=>a[37]||(a[37]=[I(" 确定 ")])),_:1})])]),default:D(()=>[x(J,{ref_key:"ruleFormRef",ref:ae,model:X.form,rules:X.rules,"label-width":"120px",class:"demo-ruleForm"},{default:D(()=>[x(C,{gutter:20},{default:D(()=>[x(V,{span:12},{default:D(()=>[x(b,{label:"角色名称",prop:"roleName"},{default:D(()=>[x(g,{modelValue:X.form.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>X.form.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1})]),_:1}),x(V,{span:12},{default:D(()=>[x(b,{prop:"roleKey"},{label:D(()=>[O("div",M,[x(j,{content:"控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)",placement:"top"},{default:D(()=>[x(r,null,{default:D(()=>[x(k)]),_:1})]),_:1}),a[32]||(a[32]=I(" 权限字符 "))])]),default:D(()=>[x(g,{modelValue:X.form.roleKey,"onUpdate:modelValue":a[1]||(a[1]=e=>X.form.roleKey=e),placeholder:"请输入权限字符"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),x(C,{gutter:20},{default:D(()=>[x(V,{span:12},{default:D(()=>[x(b,{label:"角色顺序",prop:"roleSort"},{default:D(()=>[x(S,{modelValue:X.form.roleSort,"onUpdate:modelValue":a[2]||(a[2]=e=>X.form.roleSort=e),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),x(V,{span:12},{default:D(()=>[x(b,{label:"状态"},{default:D(()=>[x(o,{class:"w100",dataType:"radio",dictCode:"sys_normal_disable",modelValue:X.form.status,"onUpdate:modelValue":a[3]||(a[3]=e=>X.form.status=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),x(C,{gutter:20},{default:D(()=>[x(V,{span:24},{default:D(()=>[x(b,{label:"菜单权限",prop:"roleSort"},{default:D(()=>[O("div",null,[O("div",null,[x(z,{modelValue:X.menuExpand,"onUpdate:modelValue":a[4]||(a[4]=e=>X.menuExpand=e),onChange:a[5]||(a[5]=e=>se(e,"menu"))},{default:D(()=>a[33]||(a[33]=[I("展开/折叠")])),_:1},8,["modelValue"]),x(z,{modelValue:X.menuNodeAll,"onUpdate:modelValue":a[6]||(a[6]=e=>X.menuNodeAll=e),onChange:a[7]||(a[7]=e=>ie(e,"menu"))},{default:D(()=>a[34]||(a[34]=[I("全选/全不选")])),_:1},8,["modelValue"]),x(z,{modelValue:X.form.menuCheckStrictly,"onUpdate:modelValue":a[8]||(a[8]=e=>X.form.menuCheckStrictly=e),onChange:a[9]||(a[9]=e=>ce(e,"menu"))},{default:D(()=>a[35]||(a[35]=[I("父子联动")])),_:1},8,["modelValue"])]),x(G,{class:"tree-border",data:X.menuOptions,"show-checkbox":"",ref_key:"treeRef",ref:te,"node-key":"id","check-strictly":!X.form.menuCheckStrictly,"empty-text":"加载中，请稍候",props:X.defaultProps},null,8,["data","check-strictly","props"])])]),_:1})]),_:1})]),_:1}),x(C,null,{default:D(()=>[x(V,{span:24},{default:D(()=>[x(b,{label:"备注"},{default:D(()=>[x(g,{modelValue:X.form.remark,"onUpdate:modelValue":a[10]||(a[10]=e=>X.form.remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),A(" 分配角色数据权限对话框 "),x(W,{title:X.title,modelValue:X.openDataScope,"onUpdate:modelValue":a[24]||(a[24]=e=>X.openDataScope=e),width:"500px","append-to-body":""},{footer:D(()=>[O("div",Q,[x(t,{type:"primary",onClick:Y},{default:D(()=>a[41]||(a[41]=[I("确 定")])),_:1}),x(t,{onClick:a[23]||(a[23]=e=>X.openDataScope=!1)},{default:D(()=>a[42]||(a[42]=[I("取 消")])),_:1})])]),default:D(()=>[x(J,{model:X.form,"label-width":"80px"},{default:D(()=>[x(b,{label:"角色名称"},{default:D(()=>[x(g,{modelValue:X.form.roleName,"onUpdate:modelValue":a[14]||(a[14]=e=>X.form.roleName=e),disabled:!0},null,8,["modelValue"])]),_:1}),x(b,{label:"权限字符"},{default:D(()=>[x(g,{modelValue:X.form.roleKey,"onUpdate:modelValue":a[15]||(a[15]=e=>X.form.roleKey=e),disabled:!0},null,8,["modelValue"])]),_:1}),x(b,{label:"权限范围"},{default:D(()=>[x(ue,{modelValue:X.form.dataScope,"onUpdate:modelValue":a[16]||(a[16]=e=>X.form.dataScope=e),onChange:e.dataScopeSelectChange},{default:D(()=>[(U(!0),N(E,null,R(X.dataScopeOptions,e=>(U(),F(oe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),q(x(b,{label:"数据权限"},{default:D(()=>[x(z,{modelValue:X.deptExpand,"onUpdate:modelValue":a[17]||(a[17]=e=>X.deptExpand=e),onChange:a[18]||(a[18]=e=>se(e,"dept"))},{default:D(()=>a[38]||(a[38]=[I("展开/折叠")])),_:1},8,["modelValue"]),x(z,{modelValue:X.deptNodeAll,"onUpdate:modelValue":a[19]||(a[19]=e=>X.deptNodeAll=e),onChange:a[20]||(a[20]=e=>ie(e,"dept"))},{default:D(()=>a[39]||(a[39]=[I("全选/全不选")])),_:1},8,["modelValue"]),x(z,{modelValue:X.form.deptCheckStrictly,"onUpdate:modelValue":a[21]||(a[21]=e=>X.form.deptCheckStrictly=e),onChange:a[22]||(a[22]=e=>ce(e,"dept"))},{default:D(()=>a[40]||(a[40]=[I("父子联动")])),_:1},8,["modelValue"]),x(G,{class:"tree-border",data:X.deptOptions,"show-checkbox":"","default-expand-all":"",ref:"dept","node-key":"id","check-strictly":!X.form.deptCheckStrictly,"empty-text":"加载中，请稍候",props:X.defaultProps},null,8,["data","check-strictly","props"])]),_:1},512),[[T,2==X.form.dataScope]])]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),x(h,{modelValue:L.value,"onUpdate:modelValue":a[25]||(a[25]=e=>L.value=e),id:n.value,onUpdate:le},null,8,["modelValue","id"])])}}});e("default",n(G,[["__file","D:/work/public/admin-tempalte-base/src/views/system/role/index.vue"]]))}}});
