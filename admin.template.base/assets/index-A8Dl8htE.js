import"./vue-BCJY8gBf.js";import{u as G,b as H}from"./vue-router-Bk-12vT2.js";import K from"./deptTree-Cvy1A-mT.js";import{i as Q,r as J,a as W}from"./index-DnKBT612.js";import{D as X}from"./index-DMBomKMH.js";import Y from"./AllRight-D5kvBKUr.js";import Z from"./addOrEdit-zP-t-uif.js";import{e as ee,l as te,f as se,d as oe,r as re}from"./user-B2FNfbOt.js";import{b as ae}from"./config-Cod_frB-.js";import{c as y,a as c}from"./element-plus-BIk4sW6s.js";import{d as ne,B as h,b as T,r as C,s as w,k as s,j as r,v as a,o as le,c as ie,y as ue,a as f,l as o,u as V,F as de,n as me}from"./@vue-BwKUEgJD.js";import"./axios-DWt2DAqT.js";import"./lodash-es-D0ldFxdg.js";import"./@element-plus-D9bzjPyL.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-riLredlm.js";import"./dayjs-CpORZXld.js";import"./async-validator-BxgltDpX.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-uXSQws5g.js";import"./pinia-TB7j859w.js";import"./vue-demi-DP18qiWf.js";import"./@vueuse-BO9Bf6Jf.js";import"./js-cookie-C1NIBS1L.js";import"./vue-i18n-DkRB_xiH.js";import"./@intlify-BnZ-SFqO.js";/* empty css                    */import"./element-easy-print-DsNlMTPy.js";import"./mockjs-CpzBLoCE.js";import"./lodash-Ce2coQ-v.js";import"./vue3-draggable-resizable-yn-CG0QmAMT.js";import"./element-easy-form-CUlqWkgt.js";import"./vuedraggable-BjUjsGh2.js";import"./@vue-monaco-B0CNy8YX.js";import"./uuid-CQkTLCs1.js";import"./drawer-A8NG3arO.js";import"./detail-BN-zf5VH.js";import"./detail-Bex21FUx.js";const pe={class:"commonBoxmp"},ce={class:"aic h100"},fe={class:"jcb aic w100"},ge={class:"aic"},_e=ne({__name:"index",setup(be){G(),H();const{parseTime:ve,addDateRange:ye,getDict:I}=Q();let k=h({sys_job_status:[]});T(async()=>{k.sys_job_status=await I("sys_job_status")}),C();const g=w(!1),l=w(""),i=w(!1),N=e=>{l.value=e.userId,g.value=!0},_=h({initPassword:"",height:0,deptOptions:[],form:{},rules:{userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:2,max:20,message:"用户名称长度必须介于 2 和 20 之间",trigger:"blur"}],nickName:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]},dateRange:[],postOptions:[],roleOptions:[],tableData:[],userVisible:!1,columnData:[{label:"用户名称",prop:"userName",render:({row:e})=>s(r("el-link"),{type:"primary",onClick:()=>N(e)},{default:()=>[e.userName]}),visible:!0,filter:{flterType:"input"}},{label:"用户昵称",prop:"nickName",visible:!0,filter:{flterType:"input"}},{label:"部门",prop:"dept.deptName",visible:!0},{label:"手机号",prop:"phonenumber",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>s(X,{values:e.status,dataType:"primary",options:k.sys_job_status,onClick:()=>B(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],operation:{label:"操作",prop:"操作",width:"180",fixed:"right",visible:!0,render:({row:e})=>s("div",null,[s(r("el-button"),{type:"primary",size:"small"},{default:()=>[a("编辑")]}),s(r("el-button"),{type:"danger",size:"small"},{default:()=>[a("删除")]})])},loading:!1}),u=h({pageNum:1,pageSize:10,deptId:void 0}),D=()=>{u.pageNum=1;const e=V(u);d.value.getList(e)},P=e=>{u.deptId=e.id,D()},U=()=>{l.value="",i.value=!0},d=C(),B=e=>{let t=e.status==="0"?"启用":"停用";y.confirm('确认要"'+t+'""'+e.userName+'"用户吗？').then(function(){const p={userId:e.userId,status:e.status};return ee(p)}).then(()=>{c.success(t+"成功"),d.value.getList()}).catch(function(){})},R=e=>{const t=e.userId;y.confirm('是否确认删除用户编号为"'+t+'"的数据项？').then(function(){return se(t)}).then(()=>{m(),c.success("删除成功")}).catch(function(){})},j=e=>{l.value=String(e.userId),me(()=>{i.value=!0})},F=e=>{y.prompt("请输入新的密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{re({userId:e.userId,password:e.value}).then(p=>{c({type:"success",message:"更新成功"}),m()})}).catch(()=>{c({type:"info",message:"Input canceled"})})},E=(e,t)=>{switch(e){case"updatePwd":F(t);break;case"updaterole":O(t);break}},O=e=>{const t=e.userId;J("/system/user-auth/role/"+t)},m=()=>{d.value.getList()},S=()=>{oe().then(e=>{_.deptOptions=e.data})};return T(()=>{ae("sys.user.initPassword").then(e=>{_.initPassword=e.msg}),m(),S()}),(e,t)=>{const p=r("el-button"),b=r("el-link"),q=r("arrow-down"),A=r("el-icon"),x=r("el-dropdown-item"),L=r("el-dropdown-menu"),M=r("el-dropdown"),z=r("el-table-column"),$=r("TableV2");return le(),ie(de,null,[ue(' v-pagePermissions="pagePermissions"  '),f("div",pe,[f("div",ce,[s(K,{style:{"margin-right":"10px"},onUpdateDept:P}),s($,{apiFunction:V(te),isInit:!1,filter:{...u},ref_key:"tableV2Ref",ref:d,columns:_.columnData},{tableHeader:o(()=>[f("div",fe,[s(p,{type:"primary",onClick:U},{default:o(()=>t[2]||(t[2]=[a("添加用户")])),_:1})])]),operation:o(()=>[s(z,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:o(n=>[f("div",ge,[s(b,{type:"primary",onClick:v=>j(n.row)},{default:o(()=>t[3]||(t[3]=[a("修改")])),_:2},1032,["onClick"]),s(b,{type:"primary",class:"mx5",onClick:v=>R(n.row)},{default:o(()=>t[4]||(t[4]=[a("删除")])),_:2},1032,["onClick"]),s(M,{onCommand:v=>E(v,n.row)},{dropdown:o(()=>[s(L,null,{default:o(()=>[s(x,{command:"updatePwd"},{default:o(()=>t[6]||(t[6]=[a("更换密码")])),_:1}),s(x,{command:"updaterole"},{default:o(()=>t[7]||(t[7]=[a("分配角色")])),_:1})]),_:1})]),default:o(()=>[s(b,{class:"ml10",type:"primary"},{default:o(()=>[t[5]||(t[5]=a(" 更多 ")),s(A,{class:"el-icon--right"},{default:o(()=>[s(q)]),_:1})]),_:1})]),_:2},1032,["onCommand"])])]),_:1})]),_:1},8,["apiFunction","filter","columns"])]),s(Y,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=n=>g.value=n),id:l.value},null,8,["modelValue","id"]),s(Z,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value=n),id:l.value,onUpdate:m},null,8,["modelValue","id"])])],2112)}}}),at=W(_e,[["__file","D:/work/public/admin-tempalte-base/src/views/system/user/index.vue"]]);export{at as default};
