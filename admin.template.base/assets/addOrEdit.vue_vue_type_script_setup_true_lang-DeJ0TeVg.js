import"./vue-BJVn-AwR.js";import{E as w}from"./element-easy-form-i7waUTjU.js";import{u as x,a as k,g as A}from"./api-Ke4kUduH.js";import{d as T,e as m,g as q}from"./index-n33gOFYA.js";import{u as B}from"./vue-i18n-DQ3J7jW3.js";import{a as g}from"./element-plus-DTmgdQLG.js";import{d as D,r as a,i as M,w as h,j as y,t as F,l as n,u as N,o as J,a as z,k as u,A as b}from"./@vue-BrpAZT_d.js";const G=D({__name:"addOrEdit",props:{modelValue:{type:Boolean,defalut:!1},id:{type:String,defalut:""}},emits:["update:modelValue","update"],setup(d,{emit:_}){const i=_;let t=d;const{t:p}=B(),r=a(!1),v=a(!1),c=a(),V=async()=>{try{const e=await c.value.validate();t.id?x(e).then(s=>{g.success(p("操作成功")),l(),i("update")}):k(e).then(s=>{g.success(p("操作成功")),l(),i("update")})}catch(e){console.log("error :>> ",e)}};M({}),a({name:""});const o=a({schema:[{label:"计量表编号",prop:"meterNumber",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请输入编号",maxlength:30,...m},rules:[{required:!0,message:"计量表编号不能为空",trigger:"change"}]},{label:"计量表名称",prop:"meterName",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请输入名称",maxlength:30,...m},rules:[{required:!0,message:"计量表名称不能为空",trigger:"change"}]},{label:"计量表类型",prop:"meterType",colAttrs:{span:12},componentName:"selectDict",attrs:{placeholder:"请选择类型",dictCode:"meter_type",...m},rules:[{required:!0,message:"计量表类型不能为空",trigger:"change"}]},{label:"计量值单位",prop:"unit",colAttrs:{span:12},componentName:"ElInput",attrs:{placeholder:"请输入计量值单位",...m},rules:[{required:!0,message:"计量值单位不能为空",trigger:"change"}]}],model:{meterNumber:"",meterName:"",meterType:"",areaName:"",unit:""},formAttrs:{"label-width":"120px",inline:!0}}),C=()=>{A(t.id).then(e=>{o.value.model=e.data,o.value.model.meterType=q(e.data.meterType)})};h(()=>t.modelValue,e=>{r.value=e,t.id&&e?C():!t.id&&e&&(o.value.model={meterNumber:"",meterName:"",meterType:"",unit:""})},{immediate:!0});const l=()=>{i("update:modelValue",!1)};return h(()=>r.value,e=>{e||l()}),(e,s)=>{const f=y("el-button"),E=y("ComDialog");return J(),F(E,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=I=>r.value=I),title:d.id?"编辑":"新增",width:N(T)},{footer:n(()=>[z("div",null,[u(f,{size:"large",onClick:l},{default:n(()=>[b("取消")]),_:1}),u(f,{size:"large",loading:v.value,type:"primary",onClick:V},{default:n(()=>[b("保存")]),_:1},8,["loading"])])]),default:n(()=>[u(N(w),{ref_key:"comFromRef",ref:c,formJson:o.value},null,8,["formJson"])]),_:1},8,["modelValue","title","width"])}}});export{G as _};
