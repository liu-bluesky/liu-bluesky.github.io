System.register(["./vue-legacy.B4Qqu2kk.js","./vue-router-legacy.CMEqzwEy.js","./index-legacy.Bt9ODvXL.js","./index-legacy.CicyPAJq.js","./role-legacy.CerxxWZc.js","./menu-legacy.CUY-SSfI.js","./element-plus-legacy.BDEdAKzd.js","./@vue-legacy.BXDSVpdI.js","./ace-builds-legacy.C216q4vo.js","./vuex-legacy.B_qzJm5s.js","./js-cookie-legacy.DG9X5X6R.js","./path-browserify-legacy.BNGKs8Xg.js","./@vueuse-legacy.DegpTP3p.js","./nprogress-legacy.CV3o_O2_.js","./axios-legacy.DpSNsPUp.js","./@element-plus-legacy.BjRGSgu5.js","./animate.css-legacy.BfzBEcwY.js","./dayjs-legacy.cn2LqUeY.js","./element-easy-form-legacy.BhPcL43a.js","./mockjs-legacy.BkkgeJ3v.js","./vuedraggable-legacy.TvIClJNq.js","./sortablejs-legacy.ROTEcU0A.js","./vue3-ace-editor-legacy.DtMI0v0s.js","./resize-observer-polyfill-legacy.0iJwNYH9.js","./uuid-legacy.2vyezZly.js","./vue-i18n-legacy.DW2dszxQ.js","./@intlify-legacy.3btIA504.js","./element-easy-print-legacy.QB0axXSJ.js","./vue3-draggable-resizable-yn-legacy.DldU9O8l.js","./lodash-es-legacy.Btr3ptxK.js","./@popperjs-legacy.CtArNnFZ.js","./@ctrl-legacy.BxnR6uzU.js","./async-validator-legacy.DmN8ALBH.js","./memoize-one-legacy.BFFEFRop.js","./normalize-wheel-es-legacy.BGuSd53u.js","./@floating-ui-legacy.-y5top_l.js"],(function(e,l){"use strict";var a,t,o,u,d,n,s,r,c,i,m,p,f,y,h,g,b,_,V,j,v,k,C,x,S,w,U,N,D,K,O,I,A,R,E,z;return{setters:[null,e=>{a=e.u,t=e.a},e=>{o=e.f,u=e.j,d=e.r},e=>{n=e._},e=>{s=e.d,r=e.l,c=e.e,i=e.f,m=e.g,p=e.h,f=e.i,y=e.j},e=>{h=e.t,g=e.r},e=>{b=e.c,_=e.a},e=>{V=e.d,j=e.v,v=e.f,k=e.r,C=e.h,x=e.c,S=e.i,w=e.j,U=e.u,N=e.o,D=e.a,K=e.m,O=e.F,I=e.k,A=e.l,R=e.R,E=e.S,z=e.x},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l={class:"commonBoxmp"},F={class:"jcb aic w100"},T={class:"aic"},q={class:"dialog-footer"},P={class:"dialog-footer"};e("default",V({__name:"index",setup(e){a(),t();const{parseTime:V,addDateRange:H,getDict:B}=o();let M=j({sys_job_status:[]});v((async()=>{M.sys_job_status=await B("sys_job_status")})),k(!0);const L=j({openDataScope:!1,defaultProps:{children:"children",label:"label"},menuOptions:[],deptOptions:[],dataScopeOptions:[{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}],deptExpand:!1,deptNodeAll:!1,menuExpand:!1,menuNodeAll:!1,title:"",form:{},userVisible:!1,rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"角色编号",prop:"roleId",visible:!0},{label:"角色名称",prop:"roleName",visible:!0},{label:"权限字符",prop:"roleKey",visible:!0},{label:"显示顺序",prop:"roleSort",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:e})=>S(n,{values:e.status,dataType:"primary",options:M.sys_job_status,onClick:()=>oe(e)},null)},{label:"创建时间",prop:"createTime",visible:!0}],loading:!1}),Q=e=>{null!=L.form.roleId&&(L.form.deptIds=(()=>{let e=$.value.getCheckedKeys(),l=$.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),c(L.form).then((e=>{L.openDataScope=!1,X()})))},G=async e=>{e&&(await e.validate(),L.form.menuIds=(()=>{let e=Z.value.getCheckedKeys(),l=Z.value.getHalfCheckedKeys();return e.unshift.apply(e,l),e})(),null!=L.form.roleId?i(L.form).then((e=>{_.success("修改成功"),L.userVisible=!1,X()})):m(L.form).then((e=>{_.success("新增成功"),L.userVisible=!1,X()})))},J=()=>{le(),L.form={},L.title="添加角色",L.userVisible=!0,z((()=>{console.log("treeRef :>> ",Z.value)}))},W=k(),X=()=>{W.value.getList()},Y=k(),Z=k(),$=k(),ee=(e,l)=>{switch(e){case"handleDataScope":(e=>{L.form={};const l=te(e.roleId);f(e.roleId).then((e=>{L.form=e.data,L.openDataScope=!0,z((()=>{l.then((e=>{$.value.setCheckedKeys(e.checkedKeys)}))})),L.title="分配数据权限"}))})(l);break;case"handleAuthUser":(e=>{const l=e.roleId;d("/system/role-auth/user/"+l)})(l)}},le=()=>{h().then((e=>{L.menuOptions=e.data}))},ae=e=>g(e).then((e=>(L.menuOptions=e.menus,e))),te=e=>y(e).then((e=>(L.deptOptions=e.depts,e))),oe=e=>{let l="0"===e.status?"启用":"停用";b.confirm('确认要"'+l+'""'+e.roleName+'"角色吗？').then((function(){return s(e.roleId,e.status)})).then((()=>{_.success(l+"成功")})).catch((function(){e.status="0"===e.status?"1":"0"}))},ue=(e,l)=>{if("menu"==l){let l=L.menuOptions;for(let a=0;a<l.length;a++)Z.value.store.nodesMap[l[a].id].expanded=e}else if("dept"==l){let l=L.deptOptions;for(let a=0;a<l.length;a++)$.value.store.nodesMap[l[a].id].expanded=e}},de=(e,l)=>{"menu"==l?Z.value.setCheckedNodes(e?L.menuOptions:[]):"dept"==l&&$.value.setCheckedNodes(e?L.deptOptions:[])},ne=(e,l)=>{"menu"==l?L.form.menuCheckStrictly=!!e:"dept"==l&&(L.form.deptCheckStrictly=!!e)};return v((()=>{X()})),(e,a)=>{const t=C("el-button"),o=C("arrow-down"),d=C("el-icon"),n=C("el-dropdown-item"),s=C("el-dropdown-menu"),c=C("el-dropdown"),i=C("el-table-column"),m=C("TableV2"),y=C("el-input"),h=C("el-form-item"),g=C("el-col"),V=C("QuestionFilled"),j=C("el-tooltip"),v=C("el-row"),k=C("el-input-number"),H=C("el-checkbox"),B=C("el-tree"),M=C("el-form"),$=C("el-dialog"),le=C("el-option"),te=C("el-select");return N(),x("div",l,[S(m,{class:"flex1",apiFunction:U(r),isInit:!1,filter:{},ref_key:"tableV2Ref",ref:W,columns:L.columnData},{tableHeader:w((()=>[D("div",F,[S(t,{type:"primary",onClick:J},{default:w((()=>[K("添加角色")])),_:1})])])),operation:w((()=>[S(i,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:w((e=>[S(t,{type:"text",onClick:l=>(e=>{const l=e.roleId,a=ae(l);f(l).then((e=>{L.title="修改角色",L.form=e.data,z((()=>{a.then((e=>{e.checkedKeys.forEach((e=>{z((()=>{Z.value.setChecked(e,!0,!1)}))}))}))})),L.userVisible=!0}))})(e.row)},{default:w((()=>[K("修改")])),_:2},1032,["onClick"]),S(t,{type:"text",onClick:l=>(e=>{const l=e.roleId;b.confirm('是否确认删除角色编号为"'+l+'"的数据项？').then((function(){return p(l)})).then((()=>{_.success("删除成功"),X()})).catch((function(){}))})(e.row)},{default:w((()=>[K("删除")])),_:2},1032,["onClick"]),S(c,{onCommand:l=>ee(l,e.row)},{dropdown:w((()=>[S(s,null,{default:w((()=>[S(n,{command:"handleDataScope"},{default:w((()=>[K("数据权限")])),_:1}),S(n,{command:"handleAuthUser"},{default:w((()=>[K("分配用户")])),_:1})])),_:1})])),default:w((()=>[S(t,{class:"ml10",type:"text"},{default:w((()=>[K(" 更多 "),S(d,{class:"el-icon--right"},{default:w((()=>[S(o)])),_:1})])),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["apiFunction","columns"]),S($,{modelValue:L.userVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>L.userVisible=e),title:L.title,width:"50%","destroy-on-close":"",center:""},{footer:w((()=>[D("span",q,[S(t,{onClick:a[11]||(a[11]=e=>L.userVisible=!1)},{default:w((()=>[K("取消")])),_:1}),S(t,{type:"primary",onClick:a[12]||(a[12]=e=>G(Y.value))},{default:w((()=>[K(" 确定 ")])),_:1})])])),default:w((()=>[S(M,{ref_key:"ruleFormRef",ref:Y,model:L.form,rules:L.rules,"label-width":"120px",class:"demo-ruleForm"},{default:w((()=>[S(v,{gutter:20},{default:w((()=>[S(g,{span:12},{default:w((()=>[S(h,{label:"角色名称",prop:"roleName"},{default:w((()=>[S(y,{modelValue:L.form.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>L.form.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1})])),_:1}),S(g,{span:12},{default:w((()=>[S(h,{prop:"roleKey"},{label:w((()=>[D("div",T,[S(j,{content:"控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)",placement:"top"},{default:w((()=>[S(d,null,{default:w((()=>[S(V)])),_:1})])),_:1}),K(" 权限字符 ")])])),default:w((()=>[S(y,{modelValue:L.form.roleKey,"onUpdate:modelValue":a[1]||(a[1]=e=>L.form.roleKey=e),placeholder:"请输入权限字符"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:w((()=>[S(g,{span:12},{default:w((()=>[S(h,{label:"角色顺序",prop:"roleSort"},{default:w((()=>[S(k,{modelValue:L.form.roleSort,"onUpdate:modelValue":a[2]||(a[2]=e=>L.form.roleSort=e),"controls-position":"right",min:0},null,8,["modelValue"])])),_:1})])),_:1}),S(g,{span:12},{default:w((()=>[S(h,{label:"状态"},{default:w((()=>[S(u,{class:"w100",dataType:"radio",dictCode:"sys_normal_disable",modelValue:L.form.status,"onUpdate:modelValue":a[3]||(a[3]=e=>L.form.status=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:w((()=>[S(g,{span:24},{default:w((()=>[S(h,{label:"菜单权限",prop:"roleSort"},{default:w((()=>[D("div",null,[D("div",null,[S(H,{modelValue:L.menuExpand,"onUpdate:modelValue":a[4]||(a[4]=e=>L.menuExpand=e),onChange:a[5]||(a[5]=e=>ue(e,"menu"))},{default:w((()=>[K("展开/折叠")])),_:1},8,["modelValue"]),S(H,{modelValue:L.menuNodeAll,"onUpdate:modelValue":a[6]||(a[6]=e=>L.menuNodeAll=e),onChange:a[7]||(a[7]=e=>de(e,"menu"))},{default:w((()=>[K("全选/全不选")])),_:1},8,["modelValue"]),S(H,{modelValue:L.form.menuCheckStrictly,"onUpdate:modelValue":a[8]||(a[8]=e=>L.form.menuCheckStrictly=e),onChange:a[9]||(a[9]=e=>ne(e,"menu"))},{default:w((()=>[K("父子联动")])),_:1},8,["modelValue"])]),S(B,{class:"tree-border",data:L.menuOptions,"show-checkbox":"",ref_key:"treeRef",ref:Z,"node-key":"id","check-strictly":!L.form.menuCheckStrictly,"empty-text":"加载中，请稍候",props:L.defaultProps},null,8,["data","check-strictly","props"])])])),_:1})])),_:1})])),_:1}),S(v,null,{default:w((()=>[S(g,{span:24},{default:w((()=>[S(h,{label:"备注"},{default:w((()=>[S(y,{modelValue:L.form.remark,"onUpdate:modelValue":a[10]||(a[10]=e=>L.form.remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),S($,{title:L.title,modelValue:L.openDataScope,"onUpdate:modelValue":a[24]||(a[24]=e=>L.openDataScope=e),width:"500px","append-to-body":""},{footer:w((()=>[D("div",P,[S(t,{type:"primary",onClick:Q},{default:w((()=>[K("确 定")])),_:1}),S(t,{onClick:a[23]||(a[23]=e=>L.openDataScope=!1)},{default:w((()=>[K("取 消")])),_:1})])])),default:w((()=>[S(M,{model:L.form,"label-width":"80px"},{default:w((()=>[S(h,{label:"角色名称"},{default:w((()=>[S(y,{modelValue:L.form.roleName,"onUpdate:modelValue":a[14]||(a[14]=e=>L.form.roleName=e),disabled:!0},null,8,["modelValue"])])),_:1}),S(h,{label:"权限字符"},{default:w((()=>[S(y,{modelValue:L.form.roleKey,"onUpdate:modelValue":a[15]||(a[15]=e=>L.form.roleKey=e),disabled:!0},null,8,["modelValue"])])),_:1}),S(h,{label:"权限范围"},{default:w((()=>[S(te,{modelValue:L.form.dataScope,"onUpdate:modelValue":a[16]||(a[16]=e=>L.form.dataScope=e),onChange:e.dataScopeSelectChange},{default:w((()=>[(N(!0),x(O,null,I(L.dataScopeOptions,(e=>(N(),A(le,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),R(S(h,{label:"数据权限"},{default:w((()=>[S(H,{modelValue:L.deptExpand,"onUpdate:modelValue":a[17]||(a[17]=e=>L.deptExpand=e),onChange:a[18]||(a[18]=e=>ue(e,"dept"))},{default:w((()=>[K("展开/折叠")])),_:1},8,["modelValue"]),S(H,{modelValue:L.deptNodeAll,"onUpdate:modelValue":a[19]||(a[19]=e=>L.deptNodeAll=e),onChange:a[20]||(a[20]=e=>de(e,"dept"))},{default:w((()=>[K("全选/全不选")])),_:1},8,["modelValue"]),S(H,{modelValue:L.form.deptCheckStrictly,"onUpdate:modelValue":a[21]||(a[21]=e=>L.form.deptCheckStrictly=e),onChange:a[22]||(a[22]=e=>ne(e,"dept"))},{default:w((()=>[K("父子联动")])),_:1},8,["modelValue"]),S(B,{class:"tree-border",data:L.deptOptions,"show-checkbox":"","default-expand-all":"",ref:"dept","node-key":"id","check-strictly":!L.form.deptCheckStrictly,"empty-text":"加载中，请稍候",props:L.defaultProps},null,8,["data","check-strictly","props"])])),_:1},512),[[E,2==L.form.dataScope]])])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}}))}}}));
