import"./vue-BCJY8gBf.js";import{u as O,b as P}from"./vue-router-Bk-12vT2.js";import{h as G,g as N,i as Q,a as $}from"./index-DnKBT612.js";import{D as T}from"./index-DMBomKMH.js";import{d as E,B as f,k as e,r as D,b as A,u as b,j as m,o as c,c as V,l as t,a as h,ag as q,v as n,x as u,y as R,q as W}from"./@vue-BwKUEgJD.js";import"./axios-DWt2DAqT.js";import"./pinia-TB7j859w.js";import"./vue-demi-DP18qiWf.js";import"./@vueuse-BO9Bf6Jf.js";import"./js-cookie-C1NIBS1L.js";import"./element-plus-BIk4sW6s.js";import"./lodash-es-D0ldFxdg.js";import"./@element-plus-D9bzjPyL.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-riLredlm.js";import"./dayjs-CpORZXld.js";import"./async-validator-BxgltDpX.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-uXSQws5g.js";import"./vue-i18n-DkRB_xiH.js";import"./@intlify-BnZ-SFqO.js";/* empty css                    */import"./element-easy-print-DsNlMTPy.js";import"./mockjs-CpzBLoCE.js";import"./lodash-Ce2coQ-v.js";import"./vue3-draggable-resizable-yn-CG0QmAMT.js";import"./element-easy-form-CUlqWkgt.js";import"./vuedraggable-BjUjsGh2.js";import"./@vue-monaco-B0CNy8YX.js";import"./uuid-CQkTLCs1.js";function X(v){return G.request({url:"/monitor/jobLog/list",method:"get",params:v})}const Y={class:"commonBoxmp"},Z={class:"jcb aic w100"},ee={key:0},te={key:1},oe={class:"dialog-footer"},le=E({__name:"log",setup(v){O();const j=P(),{parseTime:z,addDateRange:ae,getDict:k,selectDictLabel:I}=Q(),L=(i,l)=>I(_.sys_job_group,i.businessType),o=f({form:{},title:"",rules:{postName:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}],postCode:[{required:!0,message:"岗位编码不能为空",trigger:"blur"}],postSort:[{required:!0,message:"岗位顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],columnData:[{label:"日志编号",prop:"jobLogId",visible:!0},{label:"任务名称",prop:"jobName",visible:!0},{label:"任务组名",prop:"jobGroup",render:({row:i})=>e(T,{values:i.jobGroup,options:_.sys_job_group},null)},{label:"调用目标字符串",prop:"invokeTarget",visible:!0},{label:"日志信息",prop:"jobMessage",visible:!0},{label:"执行状态",render:({row:i})=>e(T,{values:i.status,options:_.sys_common_status},null),prop:"status",visible:!0},{label:"执行时间",prop:"createTime",visible:!0}],loading:!1});f({currentPage:1,total:10,pageSize:10,pageSizes:[10,20,30,40],layout:"total, prev, pager, next,sizes"});let w={pageNum:1,pageSize:10};const s=f(JSON.parse(JSON.stringify(w))),g=D(),d=()=>{s.pageNum=1;let i=b(s);g.value.getList(i)},S=()=>{Object.assign(s,w),d()},U=i=>{o.form=i,o.userVisible=!0};let _=f({sys_job_group:[],sys_common_status:[]});return D(),A(async()=>{_.sys_job_group=await k("sys_job_group"),_.sys_common_status=await k("sys_common_status");const i=j.params&&j.params.jobId;if(i){s.jobId=i;let l=b(s);g.value.getList(l)}}),(i,l)=>{const x=m("el-input"),a=m("el-form-item"),B=m("el-date-picker"),y=m("el-button"),C=m("el-form"),M=m("el-link"),F=m("el-table-column"),H=m("TableV2"),p=m("el-col"),J=m("el-row"),K=m("el-dialog");return c(),V("div",Y,[e(H,{class:"flex1",isInit:!1,ref_key:"tableV2Ref",ref:g,apiFunction:b(X),selection:"",columns:o.columnData},{tableHeader:t(()=>[h("div",Z,[e(C,{model:s,ref:"queryForm",size:"small",inline:!0},{default:t(()=>[e(a,{label:"系统模块",prop:"title"},{default:t(()=>[e(x,{modelValue:s.title,"onUpdate:modelValue":l[0]||(l[0]=r=>s.title=r),placeholder:"请输入系统模块",clearable:"",style:{width:"240px"},onKeyup:q(d,["enter","native"])},null,8,["modelValue"])]),_:1}),e(a,{label:"操作人员",prop:"operName"},{default:t(()=>[e(x,{modelValue:s.operName,"onUpdate:modelValue":l[1]||(l[1]=r=>s.operName=r),placeholder:"请输入操作人员",clearable:"",style:{width:"240px"},onKeyup:q(d,["enter","native"])},null,8,["modelValue"])]),_:1}),e(a,{label:"类型",prop:"businessType"},{default:t(()=>[e(N,{modelValue:s.businessType,"onUpdate:modelValue":l[2]||(l[2]=r=>s.businessType=r),class:"w100",onChange:d,placeholder:"操作类型",dictCode:"sys_job_group"},null,8,["modelValue"])]),_:1}),e(a,{label:"状态",prop:"status"},{default:t(()=>[e(N,{modelValue:s.status,"onUpdate:modelValue":l[3]||(l[3]=r=>s.status=r),class:"w100",onChange:d,placeholder:"操作状态",dictCode:"sys_common_status"},null,8,["modelValue"])]),_:1}),e(a,{label:"操作时间"},{default:t(()=>[e(B,{modelValue:o.dateRange,"onUpdate:modelValue":l[4]||(l[4]=r=>o.dateRange=r),style:{width:"240px"},"value-format":"yyyy-MM-dd HH:mm:ss",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),e(a,null,{default:t(()=>[e(y,{type:"primary",size:"mini",onClick:d},{default:t(()=>l[7]||(l[7]=[n("搜索")])),_:1}),e(y,{size:"mini",onClick:S},{default:t(()=>l[8]||(l[8]=[n("重置")])),_:1})]),_:1})]),_:1},8,["model"])])]),operation:t(()=>[e(F,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:t(r=>[e(M,{type:"primary",onClick:se=>U(r.row)},{default:t(()=>l[9]||(l[9]=[n("详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),e(K,{modelValue:o.userVisible,"onUpdate:modelValue":l[6]||(l[6]=r=>o.userVisible=r),title:"操作日志详细",width:"50%","destroy-on-close":"",center:""},{footer:t(()=>[h("span",oe,[e(y,{onClick:l[5]||(l[5]=r=>o.userVisible=!1)},{default:t(()=>l[10]||(l[10]=[n("取消")])),_:1})])]),default:t(()=>[e(C,{ref:"form",model:o.form,"label-width":"100px",size:"mini"},{default:t(()=>[e(J,null,{default:t(()=>[e(p,{span:12},{default:t(()=>[e(a,{label:"操作模块："},{default:t(()=>[n(u(o.form.title)+" / "+u(L(o.form)),1)]),_:1}),e(a,{label:"登录信息："},{default:t(()=>[n(u(o.form.operName)+" / "+u(o.form.operIp)+" / "+u(o.form.operLocation),1)]),_:1})]),_:1}),e(p,{span:12},{default:t(()=>[e(a,{label:"请求地址："},{default:t(()=>[n(u(o.form.operUrl),1)]),_:1}),e(a,{label:"请求方式："},{default:t(()=>[n(u(o.form.requestMethod),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"操作方法："},{default:t(()=>[n(u(o.form.method),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"请求参数："},{default:t(()=>[n(u(o.form.operParam),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[e(a,{label:"返回参数："},{default:t(()=>[n(u(o.form.jsonResult),1)]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(a,{label:"操作状态："},{default:t(()=>[o.form.status===0?(c(),V("div",ee,"正常")):o.form.status===1?(c(),V("div",te,"失败")):R("v-if",!0)]),_:1})]),_:1}),e(p,{span:8},{default:t(()=>[e(a,{label:"消耗时间："},{default:t(()=>[n(u(o.form.costTime)+"毫秒",1)]),_:1})]),_:1}),e(p,{span:10},{default:t(()=>[e(a,{label:"操作时间："},{default:t(()=>[n(u(b(z)(o.form.operTime)),1)]),_:1})]),_:1}),e(p,{span:24},{default:t(()=>[o.form.status===1?(c(),W(a,{key:0,label:"异常信息："},{default:t(()=>[n(u(o.form.errorMsg),1)]),_:1})):R("v-if",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Be=$(le,[["__file","D:/work/public/admin-tempalte-base/src/views/monitor/job/log.vue"]]);export{Be as default};
