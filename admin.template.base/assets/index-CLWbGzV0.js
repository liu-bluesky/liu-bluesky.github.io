import"./vue-D_Lb-A9Z.js";import{u as L,a as M}from"./vue-router-BVkJAzvN.js";import{h as m,f as S,k as H}from"./index-D5ps7mph.js";import{_ as K}from"./index-AC1cNjEL.js";import{a as g,c as P}from"./element-plus-FIipFbdT.js";import{d as z,i as N,b as v,r as y,j as n,c as G,k as t,l as o,u as J,o as C,a as D,A as i,t as Q,x as W}from"./@vue-BQoY7e5N.js";import"./axios-CdcsOsvR.js";import"./vuex-DyTWwpEf.js";import"./js-cookie-Cz0CWeBA.js";import"./path-browserify-D3uKt2uU.js";import"./vue-i18n-Q_0SgK56.js";import"./@intlify-fCQYzvHO.js";import"./@vueuse-4YXd5vDE.js";import"./element-easy-print-DG2WoKE1.js";import"./mockjs-DsfWEKpx.js";import"./vue3-draggable-resizable-yn-D9piuQcC.js";import"./element-easy-form-vZ9-b79u.js";import"./vuedraggable-ClYEMSPW.js";import"./sortablejs-C1wvN1Nu.js";import"./@vue-monaco-CKP0PU5x.js";import"./uuid-CQkTLCs1.js";import"./nprogress-C1nr5Arz.js";import"./@element-plus-CoZ0GdCx.js";/* empty css                    */import"./dayjs-CuLmuTop.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-D3FX-SGt.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B55MhO6l.js";function w(s){return m.request({url:"/system/dept/list",method:"get",params:s})}function X(s){return m.request({url:"/system/dept/list/exclude/"+s,method:"get"})}function Y(s){return m.request({url:"/system/dept/"+s,method:"get"})}function Z(s){return m.request({url:"/system/dept",method:"post",data:s})}function ee(s){return m.request({url:"/system/dept",method:"put",data:s})}function te(s){return m.request({url:"/system/dept/"+s,method:"delete"})}const oe={class:"commonBoxmp"},le={class:"jcb aic w100"},re={class:"dialog-footer"},Ee=z({__name:"index",setup(s){L(),M();const{parseTime:ae,addDateRange:se,handleTree:h,getDict:q}=S();let I=N({sys_job_status:[]});v(async()=>{I.sys_job_status=await q("sys_job_status")});const x=y();y(!0);const e=N({typeOptions:[],form:{},title:"",rules:{dictLabel:[{required:!0,message:"数据标签不能为空",trigger:"blur"}],dictValue:[{required:!0,message:"数据键值不能为空",trigger:"blur"}],dictSort:[{required:!0,message:"数据顺序不能为空",trigger:"blur"}]},dateRange:[],height:0,tableData:[],deptOptions:[],columnData:[{label:"部门名称",prop:"deptName",visible:!0},{label:"排序",prop:"orderNum",visible:!0},{label:"备注",prop:"remark",visible:!0},{label:"状态",prop:"status",visible:!0,render:({row:a})=>t(K,{values:a.status,dataType:"primary",options:I.sys_job_status},null)},{label:"创建时间",prop:"createTime"}],loading:!1,defaultDictType:""}),R=a=>{a&&(e.form.parentId=a[a.length-1])},T=async a=>{a&&(await a.validate(),e.form.parentId&&Array.isArray(e.form.parentId)&&(e.form.parentId=e.form.parentId[e.form.parentId.length-1]),e.form.deptId!=null?ee(e.form).then(l=>{g.success("修改成功"),e.userVisible=!1,f()}):Z(e.form).then(l=>{g.success("新增成功"),e.userVisible=!1,f()}))},U=a=>{const l=a.deptId;P.confirm('是否确认删除编号为"'+a.deptName+'"的数据项？').then(function(){return te(l)}).then(()=>{g.success("删除成功"),f()}).catch(function(){})},O=a=>{const l=a.deptId;Y(l).then(d=>{e.title="修改部门",e.form=d.data,e.userVisible=!0,X(a.deptId).then(b=>{if(e.deptOptions=h(b.data,"deptId"),e.deptOptions.length==0){const V={deptId:e.form.parentId,deptName:e.form.parentName,children:[]};e.deptOptions.push(V)}})})},j=()=>{w().then(a=>{e.deptOptions=h(a.data,"deptId")}),e.form={},e.title="新增部门",e.userVisible=!0},f=()=>{x.value.getList()},k=y();return v(()=>{f()}),(a,l)=>{const d=n("el-button"),b=n("el-table-column"),V=n("TableV2"),B=n("el-cascader"),p=n("el-form-item"),u=n("el-col"),c=n("el-row"),_=n("el-input"),F=n("el-input-number"),$=n("el-form"),A=n("el-dialog");return C(),G("div",oe,[t(V,{apiFunction:J(w),class:"flex1",dataKey:"data",ref_key:"tableV2Ref",ref:x,columns:e.columnData},{tableHeader:o(()=>[D("div",le,[t(d,{type:"primary",onClick:j},{default:o(()=>[i("添加部门")]),_:1})])]),operation:o(()=>[t(b,{label:"操作",fixed:"right",width:"160px",align:"left"},{default:o(r=>[t(d,{type:"text",onClick:E=>O(r.row)},{default:o(()=>[i("修改")]),_:2},1032,["onClick"]),t(d,{type:"text",onClick:E=>U(r.row)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["apiFunction","columns"]),t(A,{modelValue:e.userVisible,"onUpdate:modelValue":l[9]||(l[9]=r=>e.userVisible=r),title:e.title,width:"50%","destroy-on-close":"",center:""},{footer:o(()=>[D("span",re,[t(d,{onClick:l[7]||(l[7]=r=>e.userVisible=!1)},{default:o(()=>[i("取消")]),_:1}),t(d,{type:"primary",onClick:l[8]||(l[8]=r=>T(k.value))},{default:o(()=>[i(" 确定 ")]),_:1})])]),default:o(()=>[t($,{ref_key:"ruleFormRef",ref:k,model:e.form,rules:e.rules,"label-width":"120px",class:"demo-ruleForm"},{default:o(()=>[t(c,{gutter:20},{default:o(()=>[e.form.parentId!==0?(C(),Q(u,{key:0,span:24},{default:o(()=>[t(p,{label:"上级部门"},{default:o(()=>[t(B,{options:e.deptOptions,modelValue:e.form.parentId,"onUpdate:modelValue":l[0]||(l[0]=r=>e.form.parentId=r),class:"w100",props:{checkStrictly:!0,emitPath:!1,value:"deptId",label:"deptName"},clearable:"",onChange:R},null,8,["options","modelValue"])]),_:1})]),_:1})):W("",!0)]),_:1}),t(c,{gutter:20},{default:o(()=>[t(u,{span:12},{default:o(()=>[t(p,{label:"部门名称",prop:"deptName"},{default:o(()=>[t(_,{modelValue:e.form.deptName,"onUpdate:modelValue":l[1]||(l[1]=r=>e.form.deptName=r),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{span:12},{default:o(()=>[t(p,{label:"显示排序",prop:"orderNum"},{default:o(()=>[t(F,{modelValue:e.form.orderNum,"onUpdate:modelValue":l[2]||(l[2]=r=>e.form.orderNum=r),min:0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:20},{default:o(()=>[t(u,{span:12},{default:o(()=>[t(p,{label:"负责人",prop:"leader"},{default:o(()=>[t(_,{modelValue:e.form.leader,"onUpdate:modelValue":l[3]||(l[3]=r=>e.form.leader=r),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{span:12},{default:o(()=>[t(p,{label:"联系电话",prop:"phone"},{default:o(()=>[t(_,{modelValue:e.form.phone,"onUpdate:modelValue":l[4]||(l[4]=r=>e.form.phone=r),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:20},{default:o(()=>[t(u,{span:12},{default:o(()=>[t(p,{label:"状态"},{default:o(()=>[t(H,{class:"w100",deptId:"sys_normal_disable",modelValue:e.form.status,"onUpdate:modelValue":l[5]||(l[5]=r=>e.form.status=r)},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{span:12},{default:o(()=>[t(p,{label:"邮箱",prop:"email"},{default:o(()=>[t(_,{modelValue:e.form.email,"onUpdate:modelValue":l[6]||(l[6]=r=>e.form.email=r),maxlength:"50",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ee as default};
